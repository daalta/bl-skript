% !TeX spellcheck = de_DE_frami
\documentclass[fontsize=11pt, twoside=false, numbers=autoenddot]{scrbook}
\usepackage{bl_tafelanschriebe}

\pagestyle{plain}
% \pagestyle{scrheadings}
% % \chead{\headmark}
% \chead{\partmark}
% \renewcommand{\sectionmark}[1]{\markright{\textsl{#1}}}
% \renewcommand{\chaptermark}[1]{\markright{\textsl{#1}}{}}
% \renewcommand{\partmark}[1]{\markright{\textsl{#1}}}
\parindent0pt
\parskip\smallskipamount

\title{Tafelmitschriften zur Vorlesung \glqq Beschreibungslogik\grqq\\ im Sommersemester 2019}
\author{%
  Dr.\ Jean Christoph Jung, Prof.\ Dr.\ Thomas Schneider\\[1pt]
  AG Theorie der Künstlichen Intelligenz \\[1pt]
  Fachbereich 3 \\
  \includegraphics[width=.4\linewidth]{logo_ub.jpg} \\[\baselineskip]~%
}
\date{Stand: \today}
\publishers{{\large Dieses Dokument ist noch unvollständig und wird regelmäßig aktualisiert.}}

\begin{document}

\maketitle
\tableofcontents

\refstepcounter{part}
% ===================================================================
% ===================================================================
% ===================================================================
\part{Grundlagen}

% ===================================================================
\section*{T2.1~ Beispiele für {\boldmath \ALC}-Konzepte}

Mit den Konzeptnamen
%
\parI
\begin{quote}
  \term{Student}, \term{Naturwissenschaft}, \term{Professor}, \term{Emeritus},
  \term{PflichtVL}, \term{VL}, \term{Einfach}, \\ \mbox{\term{Interessant}},
  $A,B$
\end{quote}
%
\parI
und den Rollennamen
%
\parI
\begin{quote}
  \term{studiert}, \term{hält}, \term{hatÜbungsaufgabe},\\
  $r$
\end{quote} 
%
\parI
kann man z.\,B.\ folgende zusammengesetzte \ALC-Konzepte bilden:
%
\parI
\begin{itemize}
  \item
    $\term{Student} \sqcap \exists\term{studiert}.\term{Naturwissenschaft}$ \\
    (beschreibt Studierende, die mindestens eine Naturwissenschaft studieren)
    \parI
  \item
    $\term{Professor} \sqcap \term{Emeritus} \sqcap \forall\term{hält}.\lnot\term{PflichtVL}$ \\
    (beschreibt Professor*innen im Ruhestand, die keine Pflichtvorlesungen halten)
    \parI
  \item 
    $\term{VL} \sqcap \lnot\term{PflichtVL} \sqcap \forall\term{hatÜbungsaufgabe}.(\term{Einfach} \sqcup \term{Interessant})$ \\
    (beschreibt Wahlvorlesungen, bei denen alle Übungsaufgaben einfach oder interessant sind)
    \parI
  \item
    $A \sqcap \exists r.(\lnot B \sqcup \forall r.A)$
\end{itemize}
%
\parI
(Die Beschreibungen in Klammern werden eigentlich erst richtig klar, wenn die Semantik definiert ist.)

% ===================================================================
\section*{T2.2~ Beispiele für Interpretationen und Extensionen}

Wir betrachten die Interpretation $\Imc = (\Delta^\Imc,\cdot^\Imc)$ mit
%
\begin{align*}
  \Delta^\Imc            & = \{s_1,s_2,s_3,v_1,v_2\} \\[4pt]
  \term{Mensch}^\Imc     & = \{s_1,s_2,s_3\}         \\
  \term{Student}^\Imc    & = \{s_1,s_2,s_3\}         \\
  \term{Vorlesung}^\Imc  & = \{v_1,v_2\}             \\
  \term{PflichtVL}^\Imc  & = \{v_1\}                 \\
  \term{WahlVL}^\Imc     & = \{v_2\}                 \\
  \term{hört}^\Imc       & = \{(s_1,v_1),(s_2,v_1),(s_2,v_2),(s_3,v_1)\} \\
  \term{bekanntMit}^\Imc & = \{(s_1,s_2),(s_2,s_1),(s_1,s_1),(s_2,s_2),(s_3,s_3)\}.
\end{align*}
%
Jede Interpretation kann in offensichtlicher Weise als (knoten- und kantenbeschrifteter)
gerichteter Graph aufgefasst werden; für unsere Beispielinterpretation \Imc:
%
\begin{center}
  \begin{tikzpicture}[%
    >=Latex,
    every state/.style={draw=black,thin,fill=black!10,inner sep=1mm,minimum size=8mm},
    every edge/.style={draw=black,thin}
  ]
    \node[state] (s1)                                   {$s_1$};
    \node[state] (s2) [right=35mm of s1]                {$s_2$};
    \node[state] (s3) [right=35mm of s2]                {$s_3$};
    \node[state] (v1) [below right=25mm and 17mm of s1] {$v_1$};
    \node[state] (v2) [right=35mm of v1]                {$v_2$};
    
    \node [above=-1mm of s1] {\begin{tabular}{@{}c@{}}\term{Student}\\\term{Mensch}\end{tabular}};
    \node [above=-1mm of s2] {\begin{tabular}{@{}c@{}}\term{Student}\\\term{Mensch}\end{tabular}};
    \node [above=-1mm of s3] {\begin{tabular}{@{}c@{}}\term{Student}\\\term{Mensch}\end{tabular}};
    \node [below=0mm of v1] {\begin{tabular}{@{}c@{}}\term{Vorlesung}\\\term{PflichtVL}\end{tabular}};
    \node [below=0mm of v2] {\begin{tabular}{@{}c@{}}\term{Vorlesung}\\\term{WahlVL}\end{tabular}};
    
    \path[->] (s1) edge[loop left]     node[left]             {\term{bekanntMit}} ()
              (s1) edge[bend left =10] node[above]            {\term{bekanntMit}} (s2)
              (s2) edge[bend left =10] node[below]            {\term{bekanntMit}} (s1)
              (s2) edge[loop right]    node[right]            {\term{bekanntMit}} ()
              (s3) edge[loop right]    node[right]            {\term{bekanntMit}} ()
              (s1) edge                node[left =1mm]        {\term{hört}}       (v1)
              (s2) edge                node[right=1mm]        {\term{hört}}       (v1)
              (s2) edge                node[right=1mm,pos=.7] {\term{hört}}       (v2)
              (s3) edge                node[right=3mm,pos=.3] {\term{hört}}       (v1)
    ;
  \end{tikzpicture}
\end{center}
%
Beispiele für die Extensionen einiger zusammengesetzter Konzepte in dieser Interpretation:
%
\begin{alignat*}{2}
  (\term{VL} \sqcap \term{PflichtVL})^\Imc & = \{v_1,v_2\} \cap \{v_1\}          && = \{v_1\} \\
  (\lnot\term{VL})^\Imc                    & = \Delta^\Imc \setminus \{v_1,v_2\} && = \{s_1,s_2,s_3\} \\
  (\term{Student} \sqcup \term{VL})^\Imc   & = \{s_1,s_2,s_3\} \cup \{v_1,v_2\} && = \Delta^\Imc \\
  (\exists\term{bekanntMit}.\term{Student})^\Imc & = \{s_1,s_2,s_3\} \\
  (\exists\term{bekanntMit}.\exists\term{bekanntMit}.\term{Student})^\Imc & = \{s_1,s_2,s_3\} \\
  (\forall\term{hört}.\term{PflichtVL})^\Imc & = \{s_1,s_3,v_1,v_2\}
\end{alignat*}
%
In der letzten Zeile beachte man die Besonderheit der Werterestriktion ($\forall$),
dass ein Domänenelement $d$, welches \emph{keine} ausgehenden $r$-Kanten besitzt,
immer eine Instanz von $\forall r.C$ ist, für jedes beliebige Konzept $C$.

% ===================================================================
\section*{T2.3~ Semantik von {\boldmath $\top$ und $\bot$}}

Es gelten:
%
\par\vspace*{-2.7\baselineskip}
\begin{alignat*}{4}
  \top^\Imc & = (A \sqcup \lnot A)^\Imc & = A^\Imc \cup (\Delta^\Imc \setminus A^\Imc) & = \Delta^\Imc \\
  \bot^\Imc & = (A \sqcap \lnot A)^\Imc & = A^\Imc \cap (\Delta^\Imc \setminus A^\Imc) & = \emptyset^\Imc
\end{alignat*}
%
Dabei folgt die erste Gleichheit jeder Zeile aus der Definition von $\top$ bzw.\ $\bot$
auf Folie~2.9,
die zweite Gleichheit aus der Semantik (Def.~2.2)
und die dritte aus der Mengenlehre.

\pagebreak
% ===================================================================
\section*{T2.4~ Beispiele für "`unerfüllbar"' und "`subsumiert"'}

\begin{enumerate}
  \item[(a)]
    Das Konzept $C = \exists r.A \sqcap \forall r. \lnot A$ is \emph{nicht} erfüllbar:
    \par\smallskip
    Angenommen, $C$ sei erfüllbar, d.\,h.\ es gibt eine Interpretation $\Imc$
    mit $C^\Imc \neq \emptyset$. Sei $d \in C^\Imc$.
    Wegen $d \in (\exists r.A)^\Imc$ gibt es ein Element $e \in A^\Imc$
    mit $(d,e) \in r^\Imc$. Wegen $d \in (\forall r.\lnot A)^\Imc$
    gilt aber $e \in (\lnot A)^\Imc$, also $e \notin A^\Imc$,
    was ein Widerspruch zu $e \in A^\Imc$ ist. Also ist die Annahme falsch.
    \par\medskip
  \item[(b)]
    $\exists r.(A \sqcap B) \sqsubseteq \exists r.A \sqcap \exists r.B$:
    \par\smallskip
    Sei \Imc eine Interpretation und $d \in (\exists r.(A \sqcap B))^\Imc$.
    Dann gibt es ein Element $e \in (A \sqcap B)^\Imc$ mit $(d,e) \in r^\Imc$.
    Wegen $e \in A^\Imc$ gilt $d \in (\exists r.A)^\Imc$;
    wegen $e \in B^\Imc$ gilt $d \in (\exists r.B)^\Imc$.
    Also ist $d \in (\exists r.A \sqcap \exists r.B)^\Imc$.
    \par\smallskip
    Die Rückrichtung dieser Subsumtion gilt nicht -- finde ein Gegenbeispiel, d.\,h.\
    eine Interpretation $\Imc$ mit
    $(\exists r.A \sqcap \exists r.B)^\Imc \nsubseteq (\exists r.(A \sqcap B))^\Imc$.
\end{enumerate}

% ===================================================================
\section*{T2.5~ Beispiele für TBoxen und deren Semantik}

Wir betrachten folgende TBox.
\[
  \begin{tboxarray}
    \Tmc = \{
      & \term{StudentIn}   & \equiv & \term{Mensch} \sqcap \exists\term{hört}.\term{Vorlesung} & \\
      & \term{Vorlesung} & \equiv & \term{PflichtVL} \sqcup \term{WahlVL}                    & \\
      & \term{StudentIn} \sqcap \exists\term{hört}.\term{Vorlesung} & \sqsubseteq & \exists\term{bekanntMit}.\term{StudentIn} & \\
      & \term{PflichtVL} \sqcap \term{WahlVL} & \sqsubseteq & \bot & \}
  \end{tboxarray}
\]
Die Interpretation aus T2.2 ist Modell von \Tmc.
Sie erfüllt z.\,B.\ auch die folgende Konzeptinklusion.
\begin{equation}
  \label{eq:zusaetzl_KI}
  \term{StudentIn} \sqsubseteq \exists\term{bekanntMit}.\term{Mensch}
\end{equation}

Ein weiteres Modell ist z.\,B. folgende Interpretation \Jmc.
%
\begin{center}
  \begin{tikzpicture}[%
    >=Latex,
    every state/.style={draw=black,thin,fill=black!10,inner sep=1mm,minimum size=8mm},
    every edge/.style={draw=black,thin}
  ]
    \node[state] (s1)                    {$s_1$};
    \node[state] (s2) [right=35mm of s1] {$s_2$};
    \node[state] (v1) [below=15mm of s1] {$v_1$};
    
    \node [above=-1mm of s1] {\begin{tabular}{@{}c@{}}\term{StudentIn}\\\term{Mensch}\end{tabular}};
    \node [above=.4mm of s2]  {\term{Mensch}};
    \node [below=0mm of v1] {\begin{tabular}{@{}c@{}}\term{Vorlesung}\\\term{PflichtVL}\end{tabular}};
    
    \path[->] (s1) edge[loop left] node[left]  {\term{bekanntMit}} ()
              (s1) edge            node[above] {\term{bekanntMit}} (s2)
              (s1) edge            node[right] {\term{hört}}       (v1)
    ;
  \end{tikzpicture}
\end{center}
%
\Jmc erfüllt ebenfalls die Konzeptinklusion~\eqref{eq:zusaetzl_KI}
sowie z.\,B.\ $\term{VL} \equiv \term{PflichtVL}$.

\goodbreak
% ===================================================================
\section*{T2.6~ Beispiele für "`erfüllbar"' und "`subsumiert"' bzgl.\ TBoxen}

Sei \Tmc die TBox aus dem vorangehenden Beispiel.

\begin{enumerate}
  \item[(a)]
    Das Konzept
    \[
      C = \term{StudentIn} \sqcap \forall\term{hört}.\term{PflichtVL}
    \]
    ist erfüllbar bezüglich \Tmc, denn folgende Interpretation 
    $\Imc'$ ist ein Modell von \Tmc mit $s_1 \in C^{\Imc'}$:
    %
    \begin{center}
      \begin{tikzpicture}[%
        >=Latex,
        every state/.style={draw=black,thin,fill=black!10,inner sep=1mm,minimum size=8mm},
        every edge/.style={draw=black,thin}
      ]
        \node[state] (s1)                    {$s_1$};
        \node[state] (v1) [below=10mm of s1] {$v_1$};
        
        \node [above=-1mm of s1] {\begin{tabular}{@{}c@{}}\term{StudentIn}\\\term{Mensch}\end{tabular}};
        \node [below=0mm of v1] {\begin{tabular}{@{}c@{}}\term{Vorlesung}\\\term{PflichtVL}\end{tabular}};
        
        \path[->] (s1) edge[loop left] node[left]  {\term{bekanntMit}} ()
                  (s1) edge            node[right] {\term{hört}}       (v1)
        ;
      \end{tikzpicture}
    \end{center}
    %
    Ebenso ist die Interpretation \Imc aus T2.2 ein Modell von \Tmc mit $s_1 \in C^\Imc$.
    \parII
  \item[(b)]
    Das Konzept
    \[
      C = \term{StudentIn} \sqcap \forall\term{hört}.\term{PflichtVL} \sqcap \exists\term{hört}.\term{WahlVL}
    \]
    ist \emph{un}erfüllbar bezüglich \Tmc:
    Angenommen, $C$ sei erfüllbar bzgl.\ \Tmc.
    Dann gibt es ein Modell \Imc von \Tmc mit einer Instanz $d \in C^\Imc$.
    Nach der Semantik von "`$\sqcap$"' (Def.~2.2) gelten
    (i) $d \in (\forall\term{hört}.\term{PflichtVL})^\Imc$ und
    (ii) $d \in (\exists\term{hört}.\term{WahlVL})^\Imc$.
    Wegen (ii) gibt es ein Element $e \in \term{WahlVL}^\Imc$ mit $(d,e) \in \term{hört}^\Imc$.
    Wegen (i) ist dann auch $e \in \term{PflichtVL}^\Imc$,
    also $e \in (\term{PflichtVL} \sqcap \term{WahlVL})^\Imc$.
    Weil \Imc jedoch ein Modell von \Tmc ist,
    kann es wegen der Konzeptinklusion $\term{PflichtVL} \sqcap \term{WahlVL} \sqsubseteq \bot$
    aus \Tmc ein solches Element $e$ nicht geben; ein Widerspruch.
    Also ist die Annahme falsch.
    \parII
  \item[(c)]
    Für die Konzepte
    \[
      C = \term{StudentIn}
      \qquad\text{und}\qquad
      D = \exists\term{bekanntMit}.\term{StudentIn}
    \]
    gilt $\Tmc \models C \sqsubseteq D$:
    Sei \Imc ein Modell von \Tmc und $d \in C^\Imc$, d.\,h.\ $d \in \term{StudentIn}^\Imc$.
    Zu zeigen ist $d \in D^\Imc$, d.\,h.\ $d \in (\exists\term{bekanntMit}.\term{StudentIn})^\Imc$.
    
    Wegen der ersten Zeile von~\Tmc gilt
    $d \in (\exists\term{hört}.\term{Vorlesung})^\Imc$,
    also auch $d \in (\term{StudentIn} \sqcap \exists\term{hört}.\term{Vorlesung})^\Imc$.
    Mit Zeile~3 von~\Tmc folgt dann $d \in (\exists\term{bekanntMit}.\term{StudentIn})^\Imc$.    
\end{enumerate}
%
Dies ist bereits Schlussfolgern, denn wir haben implizites Wissen aus \Tmc abgeleitet:
%
\begin{enumerate}
  \item[(a)]
    Es \emph{kann} Student*innen geben, die nur Pflichtvorlesungen hören.
  \item[(b)]
    Es kann \emph{keine} Student*innen geben, die nur Pflichtvorlesungen,
    aber mindestens eine Wahlvorlesung hören.
  \item[(c)]
    Jede*r Student*in ist mit mindestens einer/m Student*in bekannt.
\end{enumerate}

% ===================================================================
\section*{T2.7~ Beweis der Monotonie von {\boldmath \ALC} (Lemma~2.7)}

\textsfbf{Lemma 2.7}~
Seien $\Tmc_1$ und $\Tmc_2$ TBoxen mit $\Tmc_1 \subseteq \Tmc_2$\,. Dann gilt:
%
\begin{enumerate}
  \item[(1)]
    Wenn $C$ erfüllbar bezüglich $\Tmc_2$ ist, dann ist $C$ erfüllbar bezüglich $\Tmc_1$.
  \item[(2)]
    Wenn $\Tmc_1 \models C \sqsubseteq D$, dann $\Tmc_2 \models C \sqsubseteq D$.
\end{enumerate}

\par\medskip\noindent
\begin{beweis}
  \begin{enumerate}
    \item[\textsfbf{(1)}]
      Sei $C$ erfüllbar bezüglich $\Tmc_2$.
      Dann gibt es ein Modell \Imc von $\Tmc_2$ mit $C^\Imc \neq \emptyset$.
      Da \Imc Modell von $\Tmc_2$ ist, erfüllt \Imc alle Konzeptinklusionen in $\Tmc_2$,
      also wegen $\Tmc_1 \subseteq \Tmc_2$ auch alle Konzeptinklusionen in $\Tmc_1$,
      und somit ist \Imc auch Modell von $\Tmc_1$.
      Also gibt es ein Modell \Imc von $\Tmc_1$ mit $C^\Imc \neq \emptyset$;
      d.\,h.\ $C$ ist erfüllbar bezüglich $\Tmc_1$.
    \item[\textsfbf{(2)}]
      Wir beweisen die Kontraposition.
      Es gelte $\Tmc_2 \not\models C \sqsubseteq D$.%
      \footnote{%
        Das Zeichen $\not\models$ steht für "`nicht $\models$"',
        also bedeutet $\Tmc \not\models C \sqsubseteq D$,
        dass die Beziehung $\Tmc \models C \sqsubseteq D$ \emph{nicht} gilt
        (d.\,h.\ bezüglich \Tmc wird $C$ \emph{nicht} von $D$ subsumiert).
%        Vergleiche auch $=$ versus $\neq$ oder $\subseteq$ versus $\nsubseteq$.
      }
      Dann gibt es ein Modell \Imc von $\Tmc_2$ mit $C^\Imc \nsubseteq D^\Imc$.
      Wie in (1) ist \Imc auch Modell von $\Tmc_1$,
      also $\Tmc_1 \not\models C \sqsubseteq D$.
      \qedhere
  \end{enumerate}
\end{beweis}
%
\par\noindent
Auf der Folie steht auch: "`Die Umkehrungen von~(1) und~(2) sind im Allgemeinen \emph{nicht} richtig."'
Davon kann man sich mittels einfacher Gegenbeispiele überzeugen:
z.\,B.\ ist mit $\Tmc_1=\emptyset$ und $\Tmc_2=\{A \sqsubseteq B\}$
die Umkehrung von~(2) widerlegt, denn $\Tmc_2 \models A \sqsubseteq B$,
aber $\Tmc_1 \not\models A \sqsubseteq B$.

\enlargethispage{10mm}
% ===================================================================
\section*{T2.8~ Beispiel für Subsumtion als Ordnungsrelation}

Wir betrachten folgende TBox.
\[
  \begin{tboxarray}
    \Tmc = \{
      & \term{PC}        & \sqsubseteq & \term{Gerät} \sqcap \exists\term{hatTeil}.\term{CPU} & \\
      & \term{PC}        & \equiv      & \term{Desktop} \sqcup \term{Laptop}                  & \\
      & \term{Desktop}   & \sqsubseteq & \lnot\term{Laptop}                                   & \\
      & \term{MobilerPC} & \equiv      & \term{PC} \sqcap \lnot \term{Desktop}                & \}
  \end{tboxarray}
\]
Die dritte Zeile von \Tmc ist äquivalent zu $\term{Desktop} \sqcap \term{Laptop} \sqsubseteq \bot$, wie man leicht zeigt (probiere es selbst aus).

Die Ordnung "`$\sqsubseteq$ bezüglich \Tmc{}"' kann man durch folgendes Hasse-Diagramm darstellen:
%
\begin{center}
  \begin{tikzpicture}[%
    sibling distance=20mm, level distance=10mm,
    every node/.style = {draw=none, fill=none, inner sep=1mm, minimum size=1mm},
    edge from parent/.style = {draw=black, thin, -}%
  ]
    \node(root) {\term{Gerät}}
      child {
        node {\term{PC}}
        child {
          node {\term{Desktop}}
        }
        child {
          node (Laptop) {\term{Laptop}}
        }
      };
      
    \node[below=0mm of Laptop] {\term{MobilerPC}};

    \node[right=30mm of root] {\term{CPU}};    
  \end{tikzpicture}%
\end{center}
%
Dass die Relation "`$\sqsubseteq$ bezüglich \Tmc{}"' \emph{nicht} antisymmetrisch ist,
zeigt sich in diesem Beispiel dadurch, dass der Knoten unten rechts zwei Beschriftungen hat,
also $\Tmc \models \term{Laptop} \equiv \term{MobilerPC}$.
Wäre die Relation antisymmetrisch, dann dürfte nicht gleichzeitig
$\Tmc \models \term{Laptop} \sqsubseteq \term{MobilerPC}$
und $\Tmc \models \term{MobilerPC} \sqsubseteq \term{Laptop}$ gelten.

% ===================================================================
\section*{T2.9~ Wechselseitige Reduktion der Schlussfolgerungsprobleme}

\textsfbf{Lemma 2.9}~
\begin{enumerate}
  \item[(1)]
    Subsumtion ist polynomiell reduzierbar auf (Un)erfüllbarkeit:
    \par\smallskip
    $\Tmc \models C \sqsubseteq D$ ~~gdw.~~ $C \sqcap \neg D$ unerfüllbar bezüglich \Tmc
    \par\smallskip
  \item[(2)]
    Erfüllbarkeit ist polynomiell reduzierbar auf (Nicht-)Äquivalenz:
    \par\smallskip
    $C$ erfüllbar bezüglich \Tmc ~~gdw.~~ $\Tmc \not\models C \equiv \bot$
    \par\smallskip
  \item[(3)]
    Äquivalenz ist polynomiell reduzierbar auf Subsumtion:
    \par\smallskip
    $\Tmc \models C \equiv D$ ~~gdw.~~ $\Tmc \models \top \sqsubseteq (C \sqcap D) \sqcup (\neg C \sqcap \neg D)$
\end{enumerate}

\par\medskip\noindent
\begin{beweis}
  Wir beweisen exemplarisch Punkt~(1). Die Beweise der anderen zwei Punkte sind analog.
  %
%  \begin{center}
%    \renewcommand{\arraystretch}{1.2}
%    \begin{tabular}{@{}lcl@{}}
%      $\Tmc \models C \sqsubseteq D$
%      & gdw. & für alle Modelle \Imc von \Tmc gilt $C^\Imc \subseteq D^\Imc$ \\
%      & gdw. & es gibt kein Modell \Imc von \Tmc mit $C^\Imc \nsubseteq D^\Imc$ \\
%      & gdw. & es gibt kein Modell \Imc von \Tmc mit $C^\Imc \cap (\Delta^\Imc \setminus D^\Imc) \neq \emptyset$ \\
%      & gdw. & es gibt kein Modell \Imc von \Tmc mit $(C \sqcap \lnot D)^\Imc \neq \emptyset$ \\
%      & gdw. & $C \sqcap \lnot D$ unerfüllbar bezüglich \Tmc
%    \end{tabular}
%  \end{center}
%  %
%  Hier gilt das erste "`gdw."' wegen der Definition von Subsumtion (Def.~2.6),
%  und die zweite Zeile ist eine logisch äquivalente Umformulierung der ersten.
%  Die dritte Zeile ist äquivalent zur zweiten, weil für beliebige Mengen $M_1,M_2$ gilt,
%  dass $M_1 \nsubseteq M_2$ gdw.\ $M_1 \cap \overline{M_2} \neq \emptyset$,
%  wobei $\overline{M_2}$ das Komplement von $M_2$ ist.
%  Man überzeuge sich davon anhand eines Venn-Diagramms.
%  Die vierte Zeile ist schließlich äquivalent zur dritten wegen der
%  Semantik von $\sqcap$ und $\lnot$ (Def.~2.2),
%  und die fünfte ist äquivalent dazu wegen der Definition von Unerfüllbarkeit (Def.~2.6).
  \begin{center}
    \renewcommand{\arraystretch}{1.2}
    \begin{tabular}{@{}lcl@{}}
      $\Tmc \models C \sqsubseteq D$
      & gdw. & für alle Modelle \Imc von \Tmc gilt $C^\Imc \subseteq D^\Imc$ \\
      & gdw. & für alle Modelle \Imc von \Tmc gilt  $C^\Imc \cap (\Delta^\Imc \setminus D^\Imc) = \emptyset$ \\
      & gdw. & für alle Modelle \Imc von \Tmc gilt  $(C \sqcap \lnot D)^\Imc = \emptyset$ \\
      & gdw. & $C \sqcap \lnot D$ unerfüllbar bezüglich \Tmc
    \end{tabular}
  \end{center}
  %
  Hier gilt das erste "`gdw."' wegen der Definition von Subsumtion (Def.~2.6),
  und die zweite Zeile ist äquivalent zur ersten, weil für beliebige Mengen $M_1,M_2$ gilt,
  dass $M_1 \subseteq M_2$ gdw.\ $M_1 \cap \overline{M_2} = \emptyset$,
  wobei $\overline{M_2}$ das Komplement von $M_2$ ist.
  Man überzeuge sich davon anhand eines Venn-Diagramms.
  Die dritte Zeile ist schließlich äquivalent zur dritten wegen der
  Semantik von $\sqcap$ und $\lnot$ (Def.~2.2),
  und die vierte ist äquivalent dazu wegen der Definition von Unerfüllbarkeit (Def.~2.6).
  \qedhere
\end{beweis}

\vspace*{-.5\baselineskip}
\enlargethispage{5mm}
% ===================================================================
\section*{T2.10~ Beispiel für inverse Rollen}

Betrachte folgende \ALC-TBox:
\[
  \begin{tboxarray}
    \Tmc = \{
      & \term{Professor} & \sqsubseteq & \term{Verrückt} \sqcap \exists\term{gibt}.\term{Vorlesung} & \\
      & \term{Vorlesung} & \sqsubseteq & \forall\term{wirdGegebenVon}.\lnot\term{Verrückt}    & \}
  \end{tboxarray}
\]
Intuitiv sollte \term{Professor} unerfüllbar bezüglich \Tmc sein;
dies ist aber nicht der Fall, weil \term{Professor} in folgendem Modell von \Tmc
eine Instanz hat:
%
\begin{center}
  \begin{tikzpicture}[%
    >=Latex,
    every state/.style={draw=black,thin,fill=black!10,inner sep=1mm,minimum size=8mm},
    every edge/.style={draw=black,thin}
  ]
    \node[state] (p)                   {$p$};
    \node[state] (v) [right=30mm of p] {$v$};
    \node[state] (d) [right=30mm of v] {$d$};
    
    \node [below=-.5mm of p] {\begin{tabular}{@{}c@{}}\term{Professor}\\\term{Verrückt}\end{tabular}};
    \node [below=0mm of v] {\term{Vorlesung}};
    \node [below=0mm of d] {\term{Dozent}};
    
    \path[->] (p) edge node[above] {\term{gibt}} (v)
              (v) edge node[above] {\term{wirdGegebenVon}} (d)
    ;
  \end{tikzpicture}
\end{center}
%
In \ALCI kann man die zweite Konzeptinklusion in \Tmc durch
\[
  \term{Vorlesung} \,\sqsubseteq\, \forall\term{gibt}^-.\lnot\term{Verrückt}
\]
ersetzen. Dann wird \term{Professor} unerfüllbar bezüglich \Tmc
(aber \Tmc hat immer noch Modelle).

\goodbreak
% ===================================================================
\section*{T2.11~ Beispiele für Zahlenrestriktionen}

Definition einer Hand als ein Organ mit genau fünf Fingern:
\[
  \term{Hand} \,\equiv\, \term{Organ} \sqcap \qnrgeq 5 {\term{hatTeil}}{\term{Finger}}
                                      \sqcap \qnrleq 5 {\term{hatTeil}}{\term{Finger}}
\]
%
\parI
Forderung, dass in jedem Semester mindestens zwei Wahlpflichtmodule angeboten werden:
\[
  \term{Semester} \,\sqsubseteq\, \qnrgeq 2 {\term{angeboten}}{\term{Wahlpflichtmodul}}
\]

% ===================================================================
\section*{T2.12~ Beispiele für die Übersetzung von {\boldmath \ALC} nach FO}

Wir betrachten folgendes \ALC-Konzept.
\[
  C = \term{Mensch} \sqcap \exists \term{hört}.\term{Vorlesung}
\]
Wir erhalten $\pi_x(C)$ anhand der induktiven Definition auf der Folie,
indem wir mit den Konzeptnamen beginnen und uns zu komplexeren Konzepten
"`hocharbeiten"':
%
\begin{align*}
  \pi_x(\term{Mensch}) & = \term{Mensch}(x)    \\
  \pi_y(\term{Vorlesung}) & = \term{Vorlesung}(y) \\
  \pi_x(\exists \term{hört}.\term{Vorlesung}) & = \exists y\big(\term{hört}(x,y) \land \term{Vorlesung}(y)\big) \\
  \pi_x(\term{Mensch} \sqcap \exists \term{hört}.\term{Vorlesung}) & = \term{Mensch}(x) \land \exists y\big(\term{hört}(x,y) \land \term{Vorlesung}(y)\big) \\[12pt]
  \text{also}\qquad
  \pi_x(C) & = \term{Mensch}(x) \land \exists y\big(\term{hört}(x,y) \land \term{Vorlesung}(y)\big)
\end{align*}
%
Wenn wir außerdem die TBox
\[
  \Tmc = \{\term{StudentIn} \equiv \term{Mensch} \sqcap \exists \term{hört}.\term{Vorlesung}\}
\]
gegeben haben, dann ist
\[
  \pi(\Tmc) = \forall x\Big(
    \term{StudentIn}(x) \leftrightarrow 
    \term{Mensch}(x) \land \exists y\big(\term{hört}(x,y) \land \term{Vorlesung}(y)\big)
  \Big).
\]

% ===================================================================
% ===================================================================
% ===================================================================
\part{Ausdrucksstärke und Modellkonstruktionen}

% ===================================================================
\section*{T3.1~ Beispiele für Bisimulationen}

\begin{enumerate}
  \item
    Für die Interpretationen
    %
    \parI
    \begin{center}
      \parbox[t]{.3\linewidth}{%
        \begin{tikzpicture}[%
          >=Latex,baseline=.2pt,
          every state/.style={draw=black,thin,fill=black!10,inner sep=1mm,minimum size=8mm},
          every edge/.style={draw=black,thin}
        ]
          \node[state] (d) {$d$};
          
          \node [left=0mm of d] (dlab) {$A$};
          
          \node [above left=0mm and 5mm of d] {$\Imc_1$};
          
          \path[->] (d) edge [loop right] node[right] {$r$} ()
          ;
        \end{tikzpicture}%
      }%
      \hspace*{.1\linewidth}
      \parbox[t]{.5\linewidth}{%
        \begin{tikzpicture}[%
          >=Latex,baseline=.2pt,
          every state/.style={draw=black,thin,fill=black!10,inner sep=1mm,minimum size=8mm},
          every edge/.style={draw=black,thin}
        ]
          \node[state]                     (x0)                    {$x_0$};
          \node[state]                     (x1) [right=10mm of x0] {$x_1$};
          \node[state]                     (x2) [right=10mm of x1] {$x_2$};
          \node[state,draw=none,fill=none] (x3) [right=10mm of x2] {$\cdots$};
          
          \node [below=0mm of x0]              {$A$};
          \node [below=0mm of x1]              {$A$};
          \node [below=0mm of x2]              {$A$};

          \node [above left=0mm and 1mm of x0] {$\Imc_2$};
          
          \path[->] (x0) edge node[above] {$r$} (x1)
                    (x1) edge node[above] {$r$} (x2)
                    (x2) edge node[above] {$r$} (x3)
          ;
        \end{tikzpicture}%
      }
    \end{center}
    %
    ist $\rho = \Delta^{\Imc_1} \times \Delta^{\Imc_2}$ eine Bisimulation.
    \parIII
  \item
    Für die Interpretationen
    %
    \parI
    \begin{center}
      \parbox[t]{.3\linewidth}{%
        \begin{tikzpicture}[%
          >=Latex,baseline=.2pt,
          every state/.style={draw=black,thin,fill=black!10,inner sep=1mm,minimum size=8mm},
          every edge/.style={draw=black,thin}
        ]
          \node[state] (d)                  {$d$};
          \node[state] (e) [below=6mm of d] {$e$};
          
          \node [left=0mm of d] {$A$};
          \node [left=0mm of e] {$A,B$};
          
          \node [above left=0mm and 12mm of d] {$\Imc_1$};
          
          \path[->] (d) edge node[right] {$r$} (e)
          ;
        \end{tikzpicture}%
      }%
      \hspace*{.1\linewidth}
      \parbox[t]{.5\linewidth}{%
        \begin{tikzpicture}[%
          >=Latex,baseline=.2pt,
          every state/.style={draw=black,thin,fill=black!10,inner sep=1mm,minimum size=8mm},
          every edge/.style={draw=black,thin}
        ]
          \node[state] (x)                                 {$x$};
          \node[state] (y)  [below left =6mm and 5mm of x] {$y$};
          \node[state] (y') [below right=6mm and 5mm of x] {$y'$};
          
          \node [above right=-2.5mm and .5mm of x]  {$A$};
          \node [left =0mm of y]                {$A,B$};
          \node [right=0mm of y']               {$A,B$};

          \node [above left=0mm and 23mm of x] {$\Imc_2$};
          
          \path[->] (x) edge node[pos=.3,left] {$r$} (y)
                    (x) edge node[pos=.3,right] {$r$} (y')
          ;
        \end{tikzpicture}%
      }
    \end{center}
    %
    \parI
    ist $\rho = \{(d,x),\,(e,y),\,(e,y')\}$ eine Bisimulation.
    \parIII
  \item
    Für die Interpretationen
    %
    \parI
    \begin{center}
      \parbox[t]{.3\linewidth}{%
        \begin{tikzpicture}[%
          >=Latex,baseline=.2pt,
          every state/.style={draw=black,thin,fill=black!10,inner sep=1mm,minimum size=8mm},
          every edge/.style={draw=black,thin}
        ]
          \node[state] (d)                   {$d$};
          \node[state] (e) [below=10mm of d] {$e$};
          
          \node[left =0mm of d] {$A,B$};
          \node[left =0mm of e] {$A$};
          
          \node [above left=0mm and 12mm of d] {$\Imc_1$};
          
          \path[->]
            (d) edge [loop right,right]    node {$r$} ()
            (d) edge [left, bend right=15] node {$s$} (e)
            (e) edge [right,bend right=15] node {$r$} (d)
          ;
        \end{tikzpicture}%
      }%
      \hspace*{.1\linewidth}
      \parbox[t]{.5\linewidth}{%
        \begin{tikzpicture}[%
          >=Latex,baseline=.2pt,
          every state/.style={draw=black,thin,fill=black!10,inner sep=1mm,minimum size=8mm},
          every edge/.style={draw=black,thin}
        ]
          \node[state] (x)                                 {$x$};
          \node[state] (y) [below left =10mm and 5mm of x] {$y$};
          \node[state] (z) [below right=10mm and 5mm of x] {$z$};
          
          \node[right=0mm of x] {$A,B$};
          \node[left =0mm of y] {$A,B$};
          \node[right=0mm of z] {$A$};

          \node [above left=0mm and 23mm of x] {$\Imc_2$};
          
          \path[->]
            (x) edge [left, bend right=15] node {$r$} (y)
            (y) edge [right,bend right=15] node {$r$} (x)
            (x) edge [right] node               {$s$} (z)
            (y) edge [below,bend right=15] node {$s$} (z)
            (z) edge [above,bend right=15] node[pos=.35] {$r$} (y)
          ;
        \end{tikzpicture}%
      }
    \end{center}
    %
    \parI
    ist $\rho = \{(d,x),\,(d,y),\,(e,z)\}$ eine Bisimulation.
\end{enumerate}

% ===================================================================
\section*{T3.2~ Beweis des Bisimulationstheorems}

\textsfbf{Theorem 3.2}~
Seien $\Imc_1,\Imc_2$ Interpretationen, $d_1 \in \Delta^{\Imc_1}$ und $d_2 \in \Delta^{\Imc_2}$.

\par\smallskip
Wenn $(\Imc_1,d_1) \sim (\Imc_2,d_2)$,~ dann gilt f\"ur alle \ALC-Konzepte $C$:
\[
  d_1 \in C^{\Imc_1}\qquad\text{gdw.}\qquad d_2 \in C^{\Imc_2}
\]      

\par\noindent
\begin{beweis}
  Sei $\rho$ eine Bisimulation zwischen $\Imc_1$ und $\Imc_2$ mit $d_1\rho d_2$.
  Wir beweisen die Behauptung per Induktion über die Struktur von $C$.
  %
  \begin{description}
    \item[Induktionsanfang.]
      Hier ist $C=A$ für einen Konzeptnamen $A$.
      Nach Bedingung (1) für Bisimulationen (Definition~3.1) gilt wie gewünscht:
      $d_1 \in A^{\Imc_1}$ gdw. $d_2 \in A^{\Imc_2}$
    \item[Induktionsschritt.]
      Wir müssen fünf Fälle gemäß des äußersten Konstruktors
      von $C$ unterscheiden $(\lnot,\sqcap,\sqcup,\exists,\forall)$.
      Wegen der (leicht nachzuweisenden) Äquivalenzen
      %
      \[
        C \sqcup D  \,\equiv\, \lnot(\lnot C \sqcap \lnot D)
        \qquad\text{und}\qquad
        \forall r.C \,\equiv\, \lnot \exists r.\lnot C
      \]
      %
      genügt es, wenn wir uns auf die drei Fälle $\lnot,\sqcap,\exists$ beschränken.
      %
      \begin{description}
        \item[{\boldmath $C=\lnot D$}]
          ~ %Dann gilt:
          %
          \parI
          \begin{center}
            \begin{tabular}{@{}llp{40mm}l@{}}
              $d_1 \in C^{\Imc_1}$ & gdw. & $d_1 \notin D^{\Imc_1}$ & (Semantik "`$\lnot$"') \\
                                   & gdw. & $d_2 \notin D^{\Imc_2}$ & (Induktionsvoraussetzung) \\
                                   & gdw. & $d_2 \in C^{\Imc_2}$    & (Semantik "`$\lnot$"')
            \end{tabular}
          \end{center}
          \parI
        \item[{\boldmath $C=D \sqcap E$}]
          ~ %Dann gilt:
          %
          \parI
          \begin{center}
            \begin{tabular}{@{}llp{40mm}l@{}}
              $d_1 \in C^{\Imc_1}$
              & gdw. & $d_1 \in D^{\Imc_1}$ und $d_1 \in E^{\Imc_1}$ & (Semantik "`$\sqcap$"') \\
              & gdw. & $d_2 \in D^{\Imc_2}$ und $d_2 \in E^{\Imc_2}$ & (Induktionsvoraussetzung)\\
              & gdw. & $d_2 \in C^{\Imc_2}$                          & (Semantik "`$\sqcap$"')
            \end{tabular}
          \end{center}
          \parI
        \item[{\boldmath $C=\exists r.D$}]
          ~\par
          Für die Richtung "`$\Rightarrow$"' argumentieren wir so:
          %
          \parIII
          $d_1 \in C^{\Imc_1}$ \\
          %
          \begin{tabular}{@{}l@{}l@{~\,}l@{~~}l@{}}
            & $\Rightarrow$ & es gibt $e_1 \in \Delta^{\Imc_1}$ mit $(d_1,e_1) \in r^{\Imc_1}$ und $e_1 \in D^{\Imc_1}$ & (Semantik "`$\exists$"') \\
            & $\Rightarrow$ & es gibt $e_2 \in \Delta^{\Imc_2}$ mit $(d_2,e_2) \in r^{\Imc_2}$ und $e_1\rho e_2$ & (Bedingung~(2) Bisim.) \\
            & $\Rightarrow$ & $e_2 \in D^{\Imc_2}$ & (Induktionsvorauss.) \\
            & $\Rightarrow$ & $d_2 \in (\exists r.D)^{\Imc_2}$ & (Semantik "`$\exists$"')
          \end{tabular}
          %
          \parIII
          Das Argument für die Richtung "`$\Leftarrow$"' ist analog,
          unter Verwendung von Bedingung~(3) für Bisimulationen.
          \qedhere
      \end{description}
  \end{description}
\end{beweis}

% ===================================================================
\section*{T3.3~ Nichtausdrückbarkeit konkreter Eigenschaften}

\textsfbf{Theorem 3.4}~
In \ALC sind \emph{nicht ausdr\"uckbar:}
%
\begin{itemize}
  \item
    das \ALCI-Konzept $\exists r^- . \top$
  \item
    die \ALCQ-Konzepte 
    %
    \begin{itemize}
      \item
        $\qnrleq n r {\top}$,~ f\"ur alle $n > 0$
      \item
        $\qnrgeq n r {\top}$,~ f\"ur alle $n > 1$
    \end{itemize}
\end{itemize}

\par\noindent
\begin{beweis}
  Siehe Proposition~3.3 und~3.4 in~\cite{DLintro}.
\end{beweis}

\goodbreak
% ===================================================================

\section*{T3.4~ Gegenbeispiel für Rückrichtung Bisimulationstheorem}

\textsfbf{Behauptung.}~
Es gibt Interpretationen \Imc und \Jmc und $d \in \Imc$, $e \in \Jmc$, so dass
\begin{enumerate}
  \item[(i)]
    $d \in C^\Imc$ gdw.\ $e \in C^\Jmc$ für alle \ALC-Konzepte $C$,
  \item[(ii)]
    aber $(\Imc,d) \not\sim (\Jmc,e)$.
\end{enumerate}

\par\noindent
\begin{beweis}
  Betrachte die folgenden Interpretationen \Imc und \Jmc.
  %
  \begin{center}
    \dots\ Bild folgt \dots
  \end{center}
  %
  Es gilt (ii):
  versucht man, eine Bisimulation $\rho$ mit $d\mathbin{\rho}e$ zu konstruieren,
  so benötigt man wegen $(e,e') \in r^\Imc$ einen $r$-Nachfolger $d'$ von $d$
  mit $d' \mathbin{\rho} e'$.
  Da jeder $r$-Nachfolger von $d$ aber nur endlich viele weitere Nachfolger hat,
  kann man wegen des unendlichen $r$-Pfads unterhalb von $e'$
  irgendwann nicht mehr Bedingung~(3) von Bisimulationen gewährleisten.
  
  \parII
  Außerdem kann man mittels struktureller Induktion zeigen, dass (i) gilt.
  \qedhere
\end{beweis}

% ===================================================================
\section*{T3.5~ Beispiel für ein Baummodell}

Sei $C = A \sqcap \exists s.B \sqcap \forall s.\exists r.A$
und $\Tmc = \{\top \sqsubseteq \exists s.A\}$.
Ein Baummodell von $C$ und \Tmc:
%
\begin{center}
  \begin{tikzpicture}[%
    >=Latex,baseline=.2pt,
    every state/.style={draw=black,thin,fill=black!10,inner sep=1mm,minimum size=4mm},
    every edge/.style={draw=black,thin}
  ]
    \node[state] (eps)                                   {};
    \node[state] (0)   [below left =6mm and 14mm of eps] {};
    \node[state] (1)   [below right=6mm and 14mm of eps] {};
    \node[state] (00)  [below left =7mm and 4mm of 0]    {};
    \node[state] (01)  [below right=7mm and 4mm of 0]    {};
    \node[state] (10)  [below left =7mm and 4mm of 1]    {};
    \node[state] (11)  [below right=7mm and 4mm of 1]    {};
    \node[state] (000) [below=8mm of 00]                 {};
    \node[state] (010) [below=8mm of 01]                 {};
    \node[state] (100) [below=8mm of 10]                 {};
    \node[state] (110) [below=8mm of 11]                 {};
    
    \node [above right=-.5mm and -.5mm of eps] {$A$};
    \node [above left =-.5mm and -.5mm of 0]   {$B$};
    \node [above right=-.5mm and -.5mm of 1]   {$A$};
    \node [right=-.5mm of 00]                  {$A$};
    \node [right=-.5mm of 01]                  {$A$};
    \node [right=-.5mm of 10]                  {$A$};
    \node [right=-.5mm of 11]                  {$A$};
    \node [right=-.5mm of 000]                 {$A$};
    \node [right=-.5mm of 010]                 {$A$};
    \node [right=-.5mm of 100]                 {$A$};
    \node [right=-.5mm of 110]                 {$A$};

    \node [inner sep=0mm,minimum size=4mm,below=8mm of 000] (0000) {$\vdots$};
    \node [inner sep=0mm,minimum size=4mm,below=8mm of 010] (0100) {$\vdots$};
    \node [inner sep=0mm,minimum size=4mm,below=8mm of 100] (1000) {$\vdots$};
    \node [inner sep=0mm,minimum size=4mm,below=8mm of 110] (1100) {$\vdots$};

    \path[->]
      (eps) edge node[pos=.25,left =2mm] {$s$} (0)
      (eps) edge node[pos=.25,right=2mm] {$s$} (1)
      (0)   edge node[pos=.3,left]       {$s$} (00)
      (0)   edge node[pos=.3,right]      {$r$} (01)
      (1)   edge node[pos=.3,left]       {$s$} (10)
      (1)   edge node[pos=.3,right]      {$r$} (11)
      (00)  edge node[right]             {$s$} (000)
      (01)  edge node[right]             {$s$} (010)
      (10)  edge node[right]             {$s$} (100)
      (11)  edge node[right]             {$s$} (110)
      (000) edge node[right]             {$s$} (0000)
      (010) edge node[right]             {$s$} (0100)
      (100) edge node[right]             {$s$} (1000)
      (110) edge node[right]             {$s$} (1100)
    ;
  \end{tikzpicture}%
\end{center}

% ===================================================================
\section*{T3.6~ Beispiel für das Unravelling}

Wir betrachten folgende Interpretation \Imc.
%
\begin{center}
  \begin{tikzpicture}[%
    >=Latex,baseline=.2pt,
    every state/.style={draw=black,thin,fill=black!10,inner sep=1mm,minimum size=8mm},
    every edge/.style={draw=black,thin}
  ]
    \node[state] (d)                   {$d$};
    \node[state] (e) [right=20mm of d] {$e$};
    
    \node[above=0mm of d] {$A,B$};
    \node[above=0mm of e] {$B$};
    
    \node [above left=0mm and 6mm of d] {$\Imc$};
    
    \path[->]
      (d) edge [loop below,below]    node {$r$} ()
      (d) edge [above, bend left=15]  node {$r$} (e)
      (e) edge [below,bend left=15]  node {$s$} (d)
      (e) edge [loop below,below]    node {$r$} ()
    ;
  \end{tikzpicture}%
\end{center}
%
Dann gibt es beispielsweise folgende $d$-Pfade:
%
\begin{itemize}
  \item
    $\rho = ddedee$ mit $\textsf{end}(\rho) = e$
  \item
    $\rho' = deeed$ mit $\textsf{end}(\rho') = d$
\end{itemize}
%
\parII
Das Unravelling von \Imc an Stelle $d$ gemäß Definition~3.7 ist
folgende Interpretation \Jmc.
%
\begin{center}
  \begin{tikzpicture}[%
    >=Latex,baseline=.2pt,
    every state/.style={draw=black,thin,fill=black!10,inner sep=.5mm,minimum size=8.5mm},
    every edge/.style={draw=black,thin}
  ]
    \node[state] (eps)                                   {$d$};
    \node[state] (0)   [below left =6mm and 20mm of eps] {$dd$};
    \node[state] (1)   [below right=6mm and 20mm of eps] {$de$};
    \node[state] (00)  [below left =7mm and 6mm of 0]    {$ddd$};
    \node[state] (01)  [below right=7mm and 6mm of 0]    {$dde$};
    \node[state] (10)  [below left =7mm and 6mm of 1]    {$ded$};
    \node[state] (11)  [below right=7mm and 6mm of 1]    {$dee$};
    
    \node [above right=-1mm and -.5mm of eps]  {$A,B$};
    \node [above left =-1mm and -.5mm of 0]    {$A,B$};
    \node [above right=-.5mm and -.5mm of 1]   {$B$};
    \node [right=-.5mm of 00]                  {\rule{0pt}{10pt}$A,B$};
    \node [right=-.5mm of 01]                  {$B$};
    \node [right=-.5mm of 10]                  {\rule{0pt}{10pt}$A,B$};
    \node [right=-.5mm of 11]                  {$B$};

%    \node [inner sep=0mm,minimum size=4mm,below=8mm of 00] (000) {$\vdots$};
%    \node [inner sep=0mm,minimum size=4mm,below=8mm of 01] (010) {$\vdots$};
%    \node [inner sep=0mm,minimum size=4mm,below=8mm of 10] (100) {$\vdots$};
%    \node [inner sep=0mm,minimum size=4mm,below=8mm of 11] (110) {$\vdots$};
%
    \node [inner sep=0mm,minimum size=4mm,below=0mm of 00] {$\vdots$};
    \node [inner sep=0mm,minimum size=4mm,below=0mm of 01] {$\vdots$};
    \node [inner sep=0mm,minimum size=4mm,below=0mm of 10] {$\vdots$};
    \node [inner sep=0mm,minimum size=4mm,below=0mm of 11] {$\vdots$};

    \node [above left=0mm and 36mm of eps] {$\Jmc$};
    
    \path[->]
      (eps) edge node[pos=.25,left =2mm] {$r$} (0)
      (eps) edge node[pos=.25,right=2mm] {$r$} (1)
      (0)   edge node[pos=.3,left]       {$r$} (00)
      (0)   edge node[pos=.3,right]      {$r$} (01)
      (1)   edge node[pos=.3,left]       {$s$} (10)
      (1)   edge node[pos=.3,right]      {$r$} (11)
%      (00)  edge node[right]             {$s$} (000)
%      (01)  edge node[right]             {$s$} (010)
%      (10)  edge node[right]             {$s$} (100)
%      (11)  edge node[right]             {$s$} (110)
    ;
  \end{tikzpicture}%
\end{center}

\goodbreak
% ===================================================================
\section*{T3.7~ Beweis des Unravelling-Lemmas}

\textsfbf{Lemma 3.8}~
Für alle \ALC-Konzepte $C$ und alle $p \in \Delta^\Jmc$ gilt:
\[
  \textsf{end}(p) \in C^\Imc \qquad\text{gdw.}\qquad p \in C^\Jmc
\]

\par\noindent
\begin{beweis}
  Mit dem Bisimulationstheorem (Theorem~3.2) genügt es zu zeigen,
  dass $\textsf{end}(p)$ und $p$ bisimilar sind,
  d.\,h.\ $\big(\Imc,\textsf{end}(p)\big) \sim (\Jmc,p)$.
  Siehe dazu Lemma~3.22 in~\cite{DLintro}.
\end{beweis}

% ===================================================================
\section*{T3.8~ Beweis der Baummodelleigenschaft von {\boldmath \ALC}}

\textsfbf{Theorem 3.6}~
Wenn ein \ALC-Konzept $C$ bezüglich einer \ALC-TBox \Tmc erfüllbar ist,
dann haben $C$ und \Tmc ein gemeinsames Baummodell \Imc.

\par\noindent
\begin{beweis}
  Siehe Theorem~3.24 in~\cite{DLintro}.
\end{beweis}

% ===================================================================
\section*{T3.9~ Beispiel für Teilkonzepte}

Sei $C = \forall r.\exists r.(A \sqcap B)$.
Dann ist $\textsf{sub}(C) = \{A,\, B,\, A \sqcap B,\, \exists r.(A \sqcap B),\, \forall r.\exists r.(A \sqcap B)\}$.

\parII
Sei $\Tmc = \{A \sqsubseteq \exists r.B,~ \forall r.B \sqsubseteq A\}$.
Dann ist $\textsf{sub}(\Tmc) = \{A,\, B,\, \exists r.B,\, \forall r.B\}$.

% ===================================================================
\section*{T3.10~ Beispiel für Typen und Filtration}

Seien $C = A \sqcap B$ und $\Tmc = \{A \sqsubseteq \exists r.A\}$.
Dann ist $\textsf{sub}(C,\Tmc) = \{A,\, B,\, A \sqcap B,\, \exists r.A\}$.

Wir betrachten die folgende Interpretation \Imc.
%
\begin{center}
  \begin{tikzpicture}[%
    >=Latex,baseline=.2pt,
    every state/.style={draw=black,thin,fill=black!10,inner sep=1mm,minimum size=8mm},
    every edge/.style={draw=black,thin}
  ]
    \node[state] (d)                   {$d$};
    \node[state] (f) [below=7mm of d] {$f$};
    \node[state] (e) [right=20mm of d] {$e$};
    \node[state] (g) [right=20mm of f] {$g$};
    
    \node[above=0mm of d] {$A$};
    \node[above=0mm of e] {$A$};
    \node[below=0mm of f] {$A,B$};
    \node[below=0mm of g] {$A$};
    
    \node [above left=0mm and 6mm of d] {$\Imc$};
    
    \path[->]
      (d) edge [above,bend left=15]  node {$r$} (e)
      (e) edge [below,bend left=15]  node {$r$} (d)
      (d) edge [left]                node {$r$} (f)
      (e) edge [right]               node {$r$} (g)
      (f) edge [below]               node {$r$} (g)
      
      (e) edge [loop right,right]    node {$r$} ()
      (g) edge [loop right,right]    node {$r$} ()
    ;
  \end{tikzpicture}%
\end{center}
%
Dann gilt für $d$ und die vier Teilkonzepte in $\textsf{sub}(C,\Tmc)$:
$d \in A^\Imc$, $d \notin B^\Imc$, $d \notin (A \sqcap B)^\Imc$ und $d \in (\exists r.A)^\Imc$.
Also ist
\[
  t_\Imc(d) = \{A,\, \exists r.A\}.
\]
Analog erhält man:
\[
  t_\Imc(e) = \{A,\, \exists r.A\}
  \qquad
  t_\Imc(f) = \{A,\, B,\, A \sqcap B,\, \exists r.A\}
  \qquad
  t_\Imc(g) = \{A,\, \exists r.A\}
\]
Es gilt also $d \simeq e \simeq g \not\simeq f$, und somit gibt es zwei Äquivalenzklassen bezüglich $\simeq$\,:
\[
  [d] = \{d,e,g\}
  \qquad
  [f] = \{f\}
\]
Die Filtration von \Imc bezüglich $C$ und \Tmc gemäß Definition~3.17 ist dann
folgende Interpretation \Jmc.
%
\begin{center}
  \begin{tikzpicture}[%
    >=Latex,baseline=.2pt,
    every state/.style={draw=black,thin,fill=black!10,inner sep=1mm,minimum size=8.5mm},
    every edge/.style={draw=black,thin}
  ]
    \node[state] (d)                   {$[d]$};
%    \node[state] (f) [below=7mm of d] {$[f]$};
    \node[state] (f) [right=20mm of d] {$[f]$};
    
    \node[above=0mm of d] {$A$};
    \node[above=0mm of f] {$A,B$};
    
    \node [above left=0mm and 12mm of d] {$\Jmc$};
    
    \path[->]
      (d) edge [above,bend left=15]  node {$r$} (f)
      (f) edge [below,bend left=15]  node {$r$} (d)
      
      (d) edge [loop left,left]      node {$r$} ()
    ;
  \end{tikzpicture}%
\end{center}

%\pagebreak[4]
% ===================================================================
\section*{T3.11~ Beweis des Filtrationstheorems}

\textsfbf{Theorem 3.17}~
Sei \Imc ein Modell von $C$ und \Tmc, und sei \Jmc die Filtration von \Imc bezüglich $C$ und \Tmc.
Dann ist auch \Jmc ein Modell von $C$ und \Tmc.

\par\noindent
\begin{beweis}
  Wir verwenden die folgende Hilfsaussage.
  %
  \begin{quote}
    Für alle $d \in \Delta^\Imc$ und $D \in \textsf{sub}(C,\Tmc)$ gilt:
    \qquad
    $d \in D^\Imc$
    \quad gdw.\quad
    $[d] \in D^\Jmc$
  \end{quote}
  %
  Für den Beweis dieser Hilfsaussage siehe Lemma~3.15 in~\cite{DLintro}.
  
  \parII
  Da \Imc ein Modell von $C$ und \Tmc ist,
  gibt es ein Element $d \in C^\Imc$.
  Mit der Hilfsaussage folgt $[d] \in C^\Jmc$; somit ist $\Jmc$ ein Modell von $C$.
  
  Um zu zeigen, dass $\Jmc$ auch ein Modell von \Tmc ist,
  betrachten wir eine beliebige Konzeptinklusion $D \sqsubseteq E \in \Tmc$
  und eine beliebige Instanz $[d] \in D^\Jmc$.
  Mit der Hilfsaussage folgt $d \in D^\Imc$;
  also $d \in E^\Imc$ (da \Tmc Modell von \Imc ist);
  also mit der Hilfsaussage $[d] \in E^\Jmc$.
  \qedhere
\end{beweis}

% ===================================================================
\section*{T3.12~ {\boldmath \ALCQI} hat nicht die endliche Modelleigenschaft}

Betrachte die TBox $\Tmc = \{(1)~ \top \sqsubseteq \exists r.\neg A,~ (2)~\top \sqsubseteq \qnrleq 1 {r^-} {\top}\}$.
Dann hat der Konzeptname $A$ bezüglich \Tmc nur \emph{unendliche Modelle}:

Sei \Imc ein Modell von $A$ und \Tmc und $d_0 \in \Delta^\Imc$.
Wir müssen zeigen, dass $|\Delta^\Imc| = \infty$.


Da \Imc Modell von \Tmc ist, muss es wegen~(1) einen $r$-Nachfolger $d_1$ von $d_0$ geben
mit $d_1 \in (\lnot A)^\Imc$. Da $d_0 \in A^\Imc$, muss $d_1 \neq d_0$ gelten.

Wegen~(1) muss es wiederum einen $r$-Nachfolger $d_2$ von $d_1$ geben
mit $d_2 \in (\lnot A)^\Imc$. Wie im vorigen Fall muss $d_1 \neq d_0$ gelten.
Außerdem muss $d_2 \neq d_1$ gelten, da sonst $d_1$ zwei $r$-Vorgänger hätte ($d_0$ und $d_1$)
und dann~(2) verletzt wäre.

Dieses Argument kann man so fortsetzen und immer wieder die Existenz eines neuen Elements
$d_{i+1}$ folgern, dass verschieden von allen $d_0,\dots,d_i$ sein muss.
Deshalb muss $\Delta^\Imc$ unendlich sein.

% ===================================================================
\section*{T3.13~ Anzahl der Interpretationen der Größe {\boldmath $\leq 2^n$}}

\textsfbf{Behauptung.}~
Sei $n = |C| + |\Tmc|$.
Dann gibt es höchstens $2^{2^{5n}}$ Interpretationen \Imc mit $|\Delta^\Imc| \leq 2^n$.

\par\noindent
\begin{beweis}
  Zunächst betrachten wir die Anzahl aller Interpretationen \Imc mit $|\Delta^\Imc| = 2^n$.
  
  Jedes Element $d \in \Delta^\Imc$ kann in $A^\Imc$ sein oder nicht,
  für jeden der $\leq n$ Konzeptnamen $A$ in $\textsf{sub}(C,\Tmc)$.
  Also gibt es $2^{2^n \cdot n}$ Möglichkeiten für die Extensionen
  der Konzeptnamen in $C$ und \Tmc.

  Jedes Paar von Elementen $(d,e) \in \Delta^\Imc \times \Delta^\Imc$
  kann in $r^\Imc$ sein oder nicht,
  für jeden der $\leq n$ Rollennamen $r$ in $\textsf{sub}(C,\Tmc)$.
  Also gibt es $2^{2^n \cdot 2^n \cdot n}$ Möglichkeiten für die Extensionen
  der Rollenamen in $C$ und \Tmc.
  
  Die Gesamtzahl der möglichen Extensionen aller Konzept- und Rollennamen
  in $C$ und \Tmc ist dann das Produkt dieser beiden Zahlen, also:
  %
  \begin{align*}
    2^{2^n \cdot n} \cdot 2^{2^n \cdot 2^n \cdot n}
    & = 2^{2^n \cdot n + 2^{2n} \cdot n}             \\
    & \leq 2^{2^{2n} + 2^{3n}}                       \\
    & \leq 2^{2 \cdot 2^{3n}}                        \\
    & = 2^{2^{3n+1}}                                 \\
    & \leq 2^{2^{4n}}
  \end{align*}
  %
  Betrachtet man nun die Anzahl der Interpretationen \Imc mit $|\Delta^\Imc| \leq 2^n$,
  dann sind dies maximal $2^n \cdot 2^{2^{4n}} = 2^{2^{4n}+n} \leq 2^{2^{5n}}$.
  \qedhere
\end{beweis}



% ===================================================================
% ===================================================================
% ===================================================================
\part{Tableau-Algorithmen}

% ===================================================================
\section*{T4.1~ Umwandlung in NNF}

\textsfbf{Lemma 4.2.}~
Jedes Konzept kann in Linearzeit in ein \"aquivalentes Konzept in NNF
umgewandelt werden.

\par\noindent
\begin{beweis}
  Dies geschieht durch erschöpfendes Anwenden folgender Regeln.
  %
  \begin{itemize}
    \item
      Auf"|lösen doppelter Negation:~
      ersetze $\lnot\lnot C$ durch $C$
    \item
      de Morgan:~
      ersetze $\lnot(C \sqcap D)$ durch $\lnot C \sqcup \lnot D$;
      ersetze $\lnot(C \sqcup D)$ durch $\lnot C \sqcap \lnot D$
    \item
      Dualität von $\exists$ und $\forall$:~
      ersetze $\lnot \exists r.C$ durch $\forall r.\lnot C$;
      ersetze $\lnot \forall r.C$ durch $\exists r.\lnot C$
  \end{itemize}
  %
  Jede Regelanwendung ist äquivalenzerhaltend und schiebt die entsprechende Negation
  weiter nach innen (oder löst sie auf).
  
  Man kann zeigen, dass linear viele Regelanwendungen ausreichen.
  \qedhere
\end{beweis}%

% ===================================================================
\section*{T4.2~ Beispiel I-Baum}

Sei $C_0 = A \sqcap \forall r.(\lnot A \sqcap \exists r.B)$.

Dann ist $\textsf{sub}(C_0) = \{A,\,B,\,\lnot A,\,\exists r.B,\,\lnot A \sqcap \exists r.B,\,
\forall r.(\lnot A \sqcap \exists r.B), C_0\}$.

Der folgende Baum ist ein I-Baum für $C_0$.
%
\begin{center}
  \begin{tikzpicture}[%
    >=Latex,baseline=.2pt,
    every state/.style={draw=black,thin,fill=black!10,inner sep=.5mm,minimum size=6mm},
    every edge/.style={draw=black,thin}
  ]
    \node[state] (eps)                                    {};
    \node[state] (0)   [below left =11mm and 20mm of eps] {};
    \node[state] (1)   [below      = 9mm          of eps] {};
    \node[state] (2)   [below right=11mm and 24mm of eps] {};
    \node[state] (00)  [below      = 9mm          of 0]   {};
    
    \node [above right=-4mm and .5mm of eps] {$\{A,B,\exists r.B\}$};
    \node [      left =         0mm of 0]   {$\{B,\lnot A\}$};
    \node [      right=         0mm of 1]   {$\{\exists r.B\}$};
    \node [      right=         0mm of 2]   {$\{A,\lnot A\}$};
    \node [      left =         0mm of 00]  {$\{\exists r.B\}$};

    \path[->]
      (eps) edge node[pos=.3,left =2mm] {$r$} (0)
      (eps) edge node[pos=.5,right]      {$s$} (1)
      (eps) edge node[pos=.3,right=2mm] {$s$} (2)
      (0)   edge node[pos=.5,left]       {$s$} (00)
    ;
  \end{tikzpicture}%
\end{center}
%
Beachte, dass die Knotenbeschriftung im Allgemeinen nicht der Semantik genügen muss;
die Tableau-Regeln werden jedoch dafür sorgen, dass sie das (größtenteils) tut.

% ===================================================================
\section*{T4.3~ Beispiel Tableau-Algorithmus}

Sei $C_0 = (\exists r.A \sqcap \exists r.\lnot A) \sqcap (\forall r.A \sqcup \forall r.B)$.
Im Folgenden ist ein möglicher%
\footnote{%
  Da die Reihenfolge der Regelanwendungen nicht festgelegt ist,
  gibt es im Allgemeinen mehrere Läufe.
  Das Ergebnis (Menge der vollständigen I-Bäume) ist jedoch
  nicht von der Reihenfolge abhängig.%
}
Lauf des Tableau-Algorithmus auf $C_0$ angegeben.
Nach den ersten drei Schritten liefert dieser folgendes Zwischenergebnis:
%
\begin{center}
  \begin{tikzpicture}[%
    >=Latex,baseline=.2pt,
    every state/.style={draw=black,thin,fill=black!10,inner sep=.5mm,minimum size=6mm},
    every edge/.style={draw=black,thin}
  ]
    \node[state] (eps)                                    {};
    
    \node [right=1mm of eps] {%
      \begin{tabular}{@{}ll@{}}
        $C_0$                                  & (1)  \\
        $\exists r.A \sqcap \exists r.\lnot A$ & (2a) \\
        $\forall r.A \sqcup \forall r.B$       & (2b) \\
        $\exists r.A, \exists r.\lnot A$       & (3)
      \end{tabular}
    };

  \end{tikzpicture}%
\end{center}
%
Dabei wurden folgende Regeln angewendet.
%
\begin{center}
  \begin{tabular}{@{}ll@{}}
    (1)        & initialer Baum $\Bmc_{\textsf{ini}}$  \\
    (2a), (2b) & $\sqcap$-Regel auf (1)             \\
    (3)        & $\sqcap$-Regel auf (2a)
  \end{tabular}
\end{center}
%
Als nächstes wenden wir die $\sqcup$-Regel auf $\forall r.A \sqcup \forall r.B$ (2b) an.
Dadurch erhalten wir zwei I-Bäume $\Bmc_1$ und $\Bmc_2$:
%
\begin{center}
  \begin{tikzpicture}[%
    >=Latex,baseline=.2pt,
    every state/.style={draw=black,thin,fill=black!10,inner sep=.5mm,minimum size=6mm},
    every edge/.style={draw=black,thin}
  ]
    \node[state] (eps)                                    {};
    
    \node [right=1mm of eps] {%
      \begin{tabular}{@{}ll@{}}
        $C_0$                                  & (1)  \\
        $\exists r.A \sqcap \exists r.\lnot A$ & (2a) \\
        $\forall r.A \sqcup \forall r.B$       & (2b) \\
        $\exists r.A,~ \exists r.\lnot A$      & (3)  \\
        $\forall r.A$                          & (4a)
      \end{tabular}
    };
    
    \node [above left=0mm and 3mm of eps] {$\Bmc_1$};

  \end{tikzpicture}%
  \hspace*{.12\linewidth}
  \begin{tikzpicture}[%
    >=Latex,baseline=.2pt,
    every state/.style={draw=black,thin,fill=black!10,inner sep=.5mm,minimum size=6mm},
    every edge/.style={draw=black,thin}
  ]
    \node[state] (eps)                                    {};
    
    \node [right=1mm of eps] {%
      \begin{tabular}{@{}ll@{}}
        $C_0$                                  & (1)  \\
        $\exists r.A \sqcap \exists r.\lnot A$ & (2a) \\
        $\forall r.A \sqcup \forall r.B$       & (2b) \\
        $\exists r.A,~ \exists r.\lnot A$      & (3)  \\
        $\forall r.B$                          & (4b)
      \end{tabular}
    };

    \node [above left=0mm and 3mm of eps] {$\Bmc_2$};

  \end{tikzpicture}%
\end{center}
%
In $\Bmc_1$ lässt sich die $\exists$-Regel auf die beiden Konzepte in (3) anwenden,
wodurch jeweils ein neuer $r$-Nachfolger des Wurzelknotens erzeugt wird:
%
\begin{center}
  \begin{tikzpicture}[%
    >=Latex,baseline=.2pt,
    every state/.style={draw=black,thin,fill=black!10,inner sep=.5mm,minimum size=6mm},
    every edge/.style={draw=black,thin}
  ]
    \node[state] (eps)                                    {};
    \node[state] (0) [below left =20mm and 15mm of eps]   {};
    \node[state] (1) [below right=20mm and  0mm of eps]   {};
    
    \node [right=1mm of eps] {%
      \begin{tabular}{@{}ll@{}}
        $C_0$                                  & (1)  \\
        $\exists r.A \sqcap \exists r.\lnot A$ & (2a) \\
        $\forall r.A \sqcup \forall r.B$       & (2b) \\
        $\exists r.A,~ \exists r.\lnot A$      & (3)  \\
        $\forall r.A$                          & (4a)
      \end{tabular}
    };

    \node [right=0mm of 0] {%
      \begin{tabular}{@{}l@{~\,}l@{}}
        $A$ & (5)
      \end{tabular}
    };

    \node [right=0mm of 1] {%
      \begin{tabular}{@{}l@{~\,}l@{}}
        $\lnot A$ & (6)
      \end{tabular}
    };

    \path[->]
      (eps) edge node[pos=.4,left =1mm] {$r$} (0)
      (eps) edge node[pos=.5,left]      {$r$} (1)
    ;
  \end{tikzpicture}%
\end{center}
%
Nun lässt sich die $\forall$-Regel auf (4a) und den rechten Nachfolger anwenden
(der linke ist bereits mit $A$ beschriftet), und wir erhalten:
%
\begin{center}
  \begin{tikzpicture}[%
    >=Latex,baseline=.2pt,
    every state/.style={draw=black,thin,fill=black!10,inner sep=.5mm,minimum size=6mm},
    every edge/.style={draw=black,thin}
  ]
    \node[state] (eps)                                    {};
    \node[state] (0) [below left =20mm and 15mm of eps]   {};
    \node[state] (1) [below right=20mm and  0mm of eps]   {};
    
    \node [right=1mm of eps] {%
      \begin{tabular}{@{}ll@{}}
        $C_0$                                  & (1)  \\
        $\exists r.A \sqcap \exists r.\lnot A$ & (2a) \\
        $\forall r.A \sqcup \forall r.B$       & (2b) \\
        $\exists r.A,~ \exists r.\lnot A$      & (3)  \\
        $\forall r.A$                          & (4a)
      \end{tabular}
    };

    \node [right=0mm of 0] {%
      \begin{tabular}{@{}l@{~\,}l@{}}
        $A$ & (5)
      \end{tabular}
    };

    \node (clash) [right=0mm of 1] {%
      \begin{tabular}{@{}l@{~\,}l@{}}
        $\lnot A$ & (6) \\
        $A$       & (7)
      \end{tabular}
    };
    
    \node [right=0mm of clash] {{\Large \lightning}};

    \path[->]
      (eps) edge node[pos=.4,left =1mm] {$r$} (0)
      (eps) edge node[pos=.5,left]      {$r$} (1)
    ;
  \end{tikzpicture}%
\end{center}
%
Dieser I-Baum ist vollständig (denn es ist keine weitere Regel anwendbar),
und er enthält einen offensichtlichen Widerspruch
wegen (6) und (7) -- ab jetzt immer mit dem Symbol~\lightning\ gekennzeichnet.

\parI
Schließlich wenden wir in $\Bmc_2$ dieselben Regeln an und erhalten
folgenden I-Baum:
%
\begin{center}
  \begin{tikzpicture}[%
    >=Latex,baseline=.2pt,
    every state/.style={draw=black,thin,fill=black!10,inner sep=.5mm,minimum size=6mm},
    every edge/.style={draw=black,thin}
  ]
    \node[state] (eps)                                    {};
    \node[state] (0) [below left =20mm and 15mm of eps]   {};
    \node[state] (1) [below right=20mm and  0mm of eps]   {};
    
    \node [right=1mm of eps] {%
      \begin{tabular}{@{}ll@{}}
        $C_0$                                  & (1)  \\
        $\exists r.A \sqcap \exists r.\lnot A$ & (2a) \\
        $\forall r.A \sqcup \forall r.B$       & (2b) \\
        $\exists r.A,~ \exists r.\lnot A$      & (3)  \\
        $\forall r.B$                          & (4b)
      \end{tabular}
    };

    \node [right=0mm of 0] {%
      \begin{tabular}{@{}l@{~\,}l@{}}
        $A$ & (8) \\
        $B$ & (10)
      \end{tabular}
    };

    \node [right=0mm of 1] {%
      \begin{tabular}{@{}l@{~\,}l@{}}
        $\lnot A$ & (9) \\
        $B$       & (11)
      \end{tabular}
    };
    
    \path[->]
      (eps) edge node[pos=.4,left =1mm] {$r$} (0)
      (eps) edge node[pos=.5,left]      {$r$} (1)
    ;
  \end{tikzpicture}%
\end{center}
%
Es wurden also folgende Regeln angewendet:
%
\begin{center}
  \begin{tabular}{@{}ll@{}}
    (8)  & $\exists$-Regel auf $\exists r.A$ (3)               \\
    (9)  & $\exists$-Regel auf $\exists r.\lnot A$ (3)         \\
    (10) & $\forall$-Regel auf (4b) und linken $r$-Nachfolger  \\
    (11) & $\forall$-Regel auf (4b) und rechten $r$-Nachfolger
  \end{tabular}
\end{center}
%
Dieser Baum ist vollständig, enthält aber \emph{keinen} offensichtlichen Widerspruch.
Somit gibt der Algorithmus auf der Eingabe $C_0$ "`erfüllbar"' zurück.

% ===================================================================
\section*{T4.4~ Verzweigungsgrad der I-Bäume}

\textsfbf{Behauptung 1.}~
Es werden nur I-Bäume mit einem
Verzweigungsgrad von maximal $|C_0|$ generiert.

\par\noindent
\begin{beweis}
  Nur die $\exists$-Regel generiert Nachfolgerknoten,
  und zwar höchstens einen pro Konzept $\exists r.C$ in $\textsf{sub}(C_0)$.
  Nach Lemma 3.13 ist aber $|\textsf{sub}(C_0)| \leq C_0$.
  \qedhere
\end{beweis}%

% ===================================================================
\section*{T4.5~ Tiefe der I-Bäume}

\textsfbf{Behauptung 2.}~
Es werden nur I-Bäume mit einer
Tiefe von maximal $|C_0|$ generiert.

\par\noindent
\begin{beweis}
  Dazu genügt es, folgende Behauptung zu beweisen:
  
  \parII
  \textsfbf{Behauptung 2a.}
  Wenn $v$ ein Knoten mit Tiefe $i$ ist,
  dann gilt für alle $C \in \Lmc(v)$:
  \[
    \textsf{rd}(C) \leq \textsf{rd}(C_0) - i
    \tag{$(*)$}
  \]
  
  \parII
  Dabei zählen wir die Tiefe eines Knotens beginnend von der Wurzel,
  welche die Tiefe 0 hat. Behauptung~2a besagt also, dass die Rollentiefe
  der Konzepte in den Knotenbeschriftungen mit der Tiefe eines Knotens abnimmt.
  
  Es ist leicht zu sehen, dass die gewünschte Behauptung~2
  bereits aus Behauptung~2a folgt:
  Wegen der Tableau-Regeln ist jeder Knoten mit mindestens einem Konzept
  beschriftet (der initiale Knoten mit $C_0$ und alle weiteren Knoten mit dem
  $C$ aus der $\exists$-Regel).
  Wenn ein generierter I-Baum also eine Tiefe $k > |C_0|$ hätte,
  dann gäbe es einen Knoten $v$ der Tiefe $k$ und in dessen Beschriftung $\Lmc(v)$
  ein Konzept $C$. Wegen Behauptung~2a wäre dann aber $\textsf{rd}(C) < 0$,
  was nicht möglich ist.
  
  \parII
  \textsfbf{Beweis von Behauptung~2a.}~
  Wir verwenden Induktion über die Anzahl der Regelanwendungen.
  %
  \begin{description}
    \item[Induktionsanfang.]
      Nach 0 Regelanwendungen gibt es nur den initialen Knoten $v_{\textsf{ini}}$
      mit $\Lmc(v_{\textsf{ini}}) = \{C_0\}$.
      Ungleichung~$(*)$ folgt, da $i=0$.
    \item[Induktionsschritt.]
      Hier unterscheiden wir vier Fälle nach der Regel, durch deren Anwendung
      das Konzept $C$ zur Knotenbeschriftung $\Lmc(v)$ hinzugefügt wurde.
      %
      \begin{description}
        \item[{\boldmath $\sqcap$-Regel.}]
          Vor der Anwendung der Regel gab es ein Konzept $C \sqcap D \in \Lmc(v)$,
          und durch die Anwendung wurden $C$ und $D$ zu $\Lmc(v)$ hinzugefügt.
          Nach Induktions\-voraussetzung ist
          $\textsf{rd}(C \sqcap D) \leq \textsf{rd}(C_0) - i$,
          also auch $\textsf{rd}(C) \leq \textsf{rd}(C_0) - i$
          wegen $\textsf{C} \leq \textsf{rd}(C \sqcap D)$.
          Analog für $\textsf{rd}(D)$.
        \item[{\boldmath $\sqcup$-Regel.}]
          Analog (probiert es selbst aus).
        \item[{\boldmath $\exists$-Regel.}]
          Vor der Anwendung der Regel gab es einen Vorgängerknoten $v'$ von $v$
          mit $\exists r.C \in \Lmc(v')$,
          und durch die Anwendung wurde $(v',r,v)$ zu $E$ hinzugefügt
          und $\Lmc(v)=\{C\}$ gesetzt.
          Nun gilt:
          %
          \begin{xalignat*}{2}
            \textsf{rd}(C)
            & = \textsf{rd}(\exists r.C) - 1 & & \text{(Definition \textsf{rd})} \\
            & \leq \Big(\textsf{rd}(C_0) - (i-1)\Big) - 1 & & \text{(Induktionsvorauss.; $v'$ hat Tiefe $i-1$)} \\
            & = \textsf{rd}(C_0) - i
          \end{xalignat*}
        \item[{\boldmath $\forall$-Regel.}]
          Ähnlich (probiert es selbst aus).
          \qedhere
      \end{description}
  \end{description}
\end{beweis}%

% ===================================================================
\section*{T4.6~ Anzahl der Regelanwendungen pro I-Baum}

Es bleibt nur noch zu zeigen, dass für $k := |C_0|$ gilt:
\[
  k^k \cdot k \leq 2^{2k^2}
\]
Das kann man wie folgt sehen:
%
\begin{xalignat*}{2}
  k^k \cdot k & = k^{k+1}                      & & \text{(Potenzgesetze)} \\
              & \leq k^{2k}                    & & \text{(da $k \geq 1$)} \\
              & = {\big(2^{\textsf{log} k}\big)}^{2k}  & & \text{(Definition Zweierlogarithmus \textsf{log})}    \\
              & = 2^{\textsf{log} k \cdot 2k}  & & \text{(Potenzgesetze)}    \\
              & \leq 2^{k \cdot 2k}            & & \text{(da $\textsf{log}(k) \leq k$)} \\
              & = 2^{2k^2}                     & &
\end{xalignat*}
%
\qedhere

% ===================================================================
\section*{T4.7~ Letzter Schritt im Terminierungsbeweis}

Wir ordnen jeder Menge $M_i$ von I-Bäumen
eine Multimenge $\textsf{MM}_i$ wie folgt zu:
Für jeden Baum $\Bmc \in M_i$ enthält $\textsf{MM}_i$ die Zahl
%
\begin{quote}
  $m(\Bmc) = {}$%
  "`$n$ minus die Anzahl $j$ der Regelanwendungen,
  mittels derer \Bmc generiert wurde"'.
\end{quote}
%
Somit ist $\textsf{MM}_i$ eine Multimenge über der
Grundmenge $\mathbb{N}$.
Da $<$ auf $\mathbb{N}$ wohlfundiert ist,
ist mit Theorem~4.7 auch $<_{\textsf{mul}}$ auf $\textsf{MM}(\mathbb{N})$
wohlfundiert.
Außerdem gilt $\textsf{MM}_i >_{\textsf{mul}} \textsf{MM}_{i+1}$ für jedes $i \geq 0$,
denn mit jeder Regelanwendung wird in $M_i$ ein I-Baum
durch maximal zwei I-Bäume $\Bmc_1,\Bmc_2$ ersetzt mit $m(\Bmc_1),m(\Bmc_2) < m(\Bmc)$;
somit erhält man $\textsf{MM}_{i+1}$ aus $\textsf{MM}_i$,
indem man $m(\Bmc)$ durch die kleineren Zahlen $m(\Bmc_1),m(\Bmc_2)$ ersetzt.

Wegen der Wohlfundiertheit von $<_{\textsf{mul}}$ und der Beobachtung
$\textsf{MM}_i >_{\textsf{mul}} \textsf{MM}_{i+1}$
muss die Folge der $\textsf{MM}_i$ endlich sein.
\qedhere

% ===================================================================
%\section*{T4.8~ Verbleibender Beweis der Korrektheit}
\newcommand{\TBewKorrTableauxOhne}{T4.8}
\section*{\hypertarget{TBewKorrTableauxOhne}{\TBewKorrTableauxOhne}~ Beweis Resolutionssatz, Korrektheit}

\textsfbf{Behauptung.}~
Für alle Konzepte $C$ und Knoten $v \in V$ gilt:
~~
$C \in \Lmc(v)$
~impliziert~
$v \in C^\Imc$

\par\medskip
Zunächst zeigen wir, dass diese Behauptung die Aussage
des Theorems~4.8 impliziert.

Da $C_0 \in \Lmc(v_{\textsf{ini}})$ in $\Bmc_{\textsf{ini}}$,
gilt auch $C_0 \in \Lmc(v_{\textsf{ini}})$ in \Bmc,
denn Knotenbeschriftungen werden durch das Anwenden der Tableauregeln
nicht gelöscht.
Also ist wegen der obigen Behauptung $v_{\textsf{ini}} \in C_0^\Imc$,
und damit ist $C_0$ erfüllbar.

\par\medskip
\textsfbf{Beweis der Behauptung}~
per Induktion über die Struktur von $C$.
%
\begin{description}
  \item[Induktionsanfang.]
    Für Konzeptnamen $C=A$ gilt die Behauptung wegen der Definition von \Imc.
  \item[Induktionsschritt.]
    Hier müssen wir für jeden der Operatoren $\lnot,\sqcap,\sqcup,\exists,\forall$
    einen gesonderten Fall betrachten, denn wegen der NNF kann man nun
    nicht mehr annehmen, dass $\sqcup$ durch $\sqcap$ oder $\forall$ durch $\exists$
    ausgedrückt wird.
    %
    \begin{description}
      \item[{\boldmath $C = \lnot A$}]
        für einen Konzeptnamen $A$.
        Da der I-Baum \Bmc keinen offensichtlichen Widerspruch enthält,
        folgt aus $\lnot A \in \Lmc(v)$,
        dass $A \notin \Lmc(v)$.
        Nach Definition von \Imc gilt dann aber $v \notin A^\Imc$,
        also $v \in (\lnot A)^\Imc$.
      \item[{\boldmath $C = D_1 \sqcap D_2$.}]
        Wenn $C \in \Lmc(v)$ in \Bmc,
        dann auch $D_1 \in \Lmc(v)$
        und $D_2 \in \Lmc(v)$,
        da \Bmc vollständig ist und somit insbesondere die
        $\sqcap$-Regel nicht anwendbar ist.
        Mit der Induktionsvoraussetzung folgt daraus nun $v \in D_1^\Imc$ und $v \in D_2^\Imc$;
        wegen der Semantik von $\sqcap$ gilt damit $v \in (D_1 \sqcap D_2)^\Imc$.
      \item[{\boldmath $C = D_1 \sqcup D_2$.}]
        Analog.
      \item[{\boldmath $C = \exists r.D$.}]
        Wegen $C \in \Lmc(v)$
        und da die $\exists$-Regel nicht anwendbar ist,
        gibt es $v' \in V$ mit $(v,r,v') \in E$ und $D \in \Lmc(v')$.
        Nach Induktionsvoraussetzung folgt aus dem letzteren,
        dass $v' \in D^\Imc$.
        Da wegen Definition von \Imc auch $(v,v') \in r^\Imc$ sein muss,
        folgt $v \in (\exists r.D)^\Imc$ mit der Semantik von $\exists$.
      \item[{\boldmath $C = \forall r.D$.}]
        Ähnlich.
        \qedhere
    \end{description}
\end{description}

\goodbreak

% ===================================================================
\section*{T4.9~ Beispiel für Realisierbarkeit}

Das folgende Bild zeigt einen I-Baum \Bmc (links)
und eine Interpretation \Imc, die \Bmc realisiert, (rechts)
sowie die zugehörige Abbildung $\pi$ gemäß Definition~4.9 (gestrichelte Pfeile).
%
\begin{center}
  \begin{tikzpicture}[%
    >=Latex,baseline=.2pt,
    every state/.style={draw=black,thin,fill=black!10,inner sep=.5mm,minimum size=6mm},
    every edge/.style={draw=black,thin}
  ]
    \node[state] (leps)                                   {};
    \node[state] (l0)  [below left =12mm and 7mm of leps] {};
    \node[state] (l1)  [below right=12mm and 7mm of leps] {};
    \node[state] (l00) [below      =12mm         of l0]   {};
    \node[state] (l10) [below      =12mm         of l1]   {};
    
    \node[state] (reps) [right=65mm of leps]                {};
    \node[state] (r0)   [below left =12mm and 14mm of reps] {};
    \node[state] (r1)   [below right=12mm and  5mm of reps] {};
    \node[state] (r2)   [below right=12mm and 20mm of reps] {};
    \node[state] (r00)  [below      =12mm          of r0]   {};
    \node[state] (r10)  [below left =12mm and  2mm of r1]   {};
    \node[state] (r11)  [below right=12mm and  2mm of r1]   {};
    \node[state] (r100) [below      =12mm          of r10]  {};
    
    \node [left =0mm of leps] {$\{A,\,\exists t.B\}$};
    \node [left =0mm of l0]   {$\{B,\,\forall r.B\}$};
    \node [left =0mm of l1]   {$\emptyset$};
    \node [left =0mm of l00]  {$\{B\}$};
    \node [left =0mm of l10]  {$\{\exists r.A\}$};

    \node [right=0mm of reps] {$A$};
    \node [right=0mm of r0]   {$B$};
    \node [right=0mm of r2]   {$A,B$};
    \node [right=0mm of r00]  {$A,B$};
    \node [right=0mm of r11]  {$B$};
    \node [right=0mm of r100] {$A$};
    
    \node [above=5mm of leps] {I-Baum \Bmc};
    \node [above=5mm of reps] {realisierende Interpretation \Imc};

    \path[->]
      (leps) edge node[pos=.4,left =1mm] {$r$} (l0)
      (leps) edge node[pos=.3,right=1mm] {$s$} (l1)
      (l0)   edge node[left]             {$r$} (l00)
      (l1)   edge node[pos=.4,right]     {$r$} (l10)

      (reps) edge node[pos=.4, left =1mm]  {$r$} (r0)
      (reps) edge node[pos=.55,left =.5mm] {$s$} (r1)
      (reps) edge node[pos=.4, right=2mm]  {$t$} (r2)
      (r0)   edge node[pos=.6,left]        {$r$} (r00)
      (r1)   edge node[pos=.4, left =.5mm] {$r$} (r10)
      (r1)   edge node[pos=.4, right=.5mm] {$r$} (r11)
      (r10)  edge node[left]               {$r$} (r100)
    ;
    
    \path[->,densely dashed]
      (leps) edge [bend left =20] node [below]         {$\pi$} (reps)
      (l0)   edge [bend left =20] node [pos=.76,below] {$\pi$} (r0)
      (l1)   edge [bend right=17] node [pos=.32,above] {$\pi$} (r1)
      (l00)  edge [bend left =20] node [pos=.76,below] {$\pi$} (r00)
      (l10)  edge [bend right=22] node [pos=.355,above] {$\pi$} (r10)
    ;
  \end{tikzpicture}%
\end{center}
%
Man beachte, dass die Knoten von \Bmc (links) mit Mengen von Konzepten beschriftet sind,
aber die Elemente von \Imc (rechts) mit Konzept\emph{namen} -- so, wie wir Interpretationen
immer darstellen.

% ===================================================================
\section*{T4.10~ Verbleibender Beweis der Vollständigkeit}

\textsfbf{Behauptung.}~
Für alle $i \leq n$ ist $M_i$ realisierbar.

\begin{beweis}
  Per Induktion über $i$.
  %
  \begin{description}
    \item[Induktionsanfang.]
      $M_0 = \{\Bmc_{\textsf{ini}}\}$ ist realisierbar,
      da $\Bmc_{\textsf{ini}}$ realisierbar ist,
      und zwar durch ein beliebiges Modell von $C_0$
      (welches existiert, da $C_0$ nach Voraussetzung von Theorem~4.10 erfüllbar ist).
    \item[Induktionsschritt.]
      Wir nehmen an, dass $M_i$ realisierbar sei,
      und zeigen, dass dann auch $M_{i+1}$ realisierbar ist.
      Dazu unterscheiden wir vier Fälle gemäß der Regel,
      mit der $M_{i+1}$ aus $M_i$ erzeugt wird.
      Sei also $\Bmc=(V,E,\Lmc)$ ein realisierbarer Baum aus $M_i$,
      auf den eine Regel angewendet wird.
      \begin{description}
        \item[{\boldmath $\sqcup$-Regel.}]
          Dann entsteht $M_{i+1}$ aus $M_i$,
          indem \Bmc durch zwei Bäume $\Bmc' = (V,E,\Lmc')$ und $\Bmc'' = (V,E,\Lmc'')$
          ersetzt wird,
          und es gibt einen Knoten $v \in V$ mit
          %
          \begin{itemize}
            \item
              $C \sqcup D \in \Lmc(v)$;
            \item
              $\Lmc'(v) = \Lmc(v) \cup \{C\}$,\quad $\Lmc''(v) = \Lmc(v) \cup \{D\}$;
            \item
              $\Lmc'(u) = \Lmc''(u) = \Lmc(u)$ für alle $u \neq v$.
          \end{itemize}
          %
          Es genügt zu zeigen: wenn \Bmc realisierbar, dann $\Bmc'$ realisierbar
          \emph{oder} $\Bmc''$ realisierbar.
          
          Sei \Imc eine Interpretation, die \Bmc realisiert,
          und $\pi : V \to \Delta^\Imc$ die zugehörige Abbildung gemäß Definition~4.9.
          Dann gilt insbesondere $\pi(v) \in (C \sqcup D)^\Imc$.
          Nach Semantik von $\sqcup$ ist dann $\pi(v) \in C^\Imc$ oder $\pi(v) \in D^\Imc$.
          Im ersten Fall realisiert \Imc den Baum $\Bmc'$, im zweiten $\Bmc''$.
        \item[{\boldmath $\sqcap$-Regel.}]
          Analog, aber mit nur \emph{einem} Baum $\Bmc'$ (probiert es selbst aus).
        \item[{\boldmath $\exists$-Regel.}]
          Dann entsteht $M_{i+1}$ aus $M_i$,
          indem \Bmc durch einen Baum $\Bmc' = (V',E',\Lmc')$ ersetzt wird,
          und es gibt Knoten $v,v' \in V$ mit
          %
          \begin{itemize}
            \item
              $\exists r.C \in \Lmc(v)$;
            \item
              $V' = V \uplus \{v'\}$,\quad $E' = E \cup \{(v,r,v')\}$
            \item
              $\Lmc'(v') = \{C\}$;
            \item
              $\Lmc'(u) = \Lmc(u)$ für alle $u \neq v'$.
          \end{itemize}
          %
          Es genügt zu zeigen: wenn \Bmc realisierbar, dann $\Bmc'$ realisierbar.

          Sei \Imc eine Interpretation, die \Bmc realisiert,
          und $\pi : V \to \Delta^\Imc$ die zugehörige Abbildung gemäß Definition~4.9.
          Dann gilt insbesondere $\pi(v) \in (\exists r.C)^\Imc$,
          also gibt es ein $d \in \Delta^\Imc$ mit $(\pi(v),d) \in r^\Imc$
          und $d \in C^\Imc$.
          Wenn man nun $\pi$ erweitert um $\pi(v') = d$,
          dann bezeugt die resultierende Funktion,
          dass $\Bmc'$ durch \Imc realisiert wird.
        \item[{\boldmath $\forall$-Regel.}]
          Ähnlich (probiert es selbst aus).
          \qedhere
      \end{description}
  \end{description}
\end{beweis}

% ===================================================================
\section*{T4.11~ Beispiel für den Worst Case bei der Komplexitätsanalyse}

Sei $n=2$. Dann ist
$C_0 = \forall r^0.(\exists r.B \sqcap \exists r.\lnot B) \sqcap
       \forall r^1.(\exists r.B \sqcap \exists r.\lnot B)$.
(Folie~4.25).
Kürzt man nun das doppelt vorkommende Teilkonzept ab mit
%
%\begin{align*}
%  D & = \exists r.B \sqcap \exists r.\lnot B,
%  \intertext{dann ist}
%  C & = D \sqcap \forall r.D.
%\end{align*}
%
$D = \exists r.B \sqcap \exists r.\lnot B$, dann ist
\[
  C_0 = D \sqcap \forall r.D.
\]
Der Tableau-Algorithmus erzeugt folgenden I-Baum, 
der auf dem vollständigen Binärbaum der Tiefe 2 basiert:
%
\vspace*{-\baselineskip}
\begin{center}
  \begin{tikzpicture}[%
    >=Latex,baseline=.2pt,
    every state/.style={draw=black,thin,fill=black!10,inner sep=.5mm,minimum size=6mm},
    every edge/.style={draw=black,thin}
  ]
    \node[state] (eps)                                   {};
    \node[state] (0)  [below left =13mm and 18mm of eps] {};
    \node[state] (1)  [below right=13mm and 18mm of eps] {};
    \node[state] (00) [below left =11mm and  4mm of 0]   {};
    \node[state] (01) [below right=11mm and  4mm of 0]   {};
    \node[state] (10) [below left =11mm and  4mm of 1]   {};
    \node[state] (11) [below right=11mm and  4mm of 1]   {};
    
    \node [above right=-8mm and 2mm of eps] {%
      \begin{tabular}{@{}l@{}}
        $C_0$                             \\
        $D,~ \forall r.D$                 \\
        $\exists r.B,~ \exists r.\lnot B$
      \end{tabular}
    };

    \node [left=1mm of 0] {%
      \begin{tabular}{@{}r@{}}
        $B,~D$                            \\
        $\exists r.B,~ \exists r.\lnot B$
      \end{tabular}
    };

    \node [right=1mm of 1] {%
      \begin{tabular}{@{}l@{}}
        $\lnot B,~D$                      \\
        $\exists r.B,~ \exists r.\lnot B$
      \end{tabular}
    };

    \node [left =0mm of 00] {$B$};
    \node [right=0mm of 01] {$\lnot B$};
    \node [left =0mm of 10] {$B$};
    \node [right=0mm of 11] {$\lnot B$};

    \path[->]
      (eps) edge node[pos=.45,left =1mm] {$r$} (0)
      (eps) edge node[pos=.45,right=1mm] {$r$} (1)
      (0)   edge node[pos=.5, left =1mm] {$r$} (00)
      (0)   edge node[pos=.5, right=1mm] {$r$} (01)
      (1)   edge node[pos=.5, left =1mm] {$r$} (10)
      (1)   edge node[pos=.5, right=1mm] {$r$} (11)
    ;
  \end{tikzpicture}%
\end{center}
%
Es sollte nun leicht zu sehen sein, dass für beliebiges $n$ der entsprechende I-Baum
auf dem vollständigen Binärbaum der Tiefe $n$ basiert, welcher $2^n$ Knoten hat.

\goodbreak

\newcommand{\nr}[1]{%
  \tikz[%
    baseline=-3pt,
    every state/.style={rectangle,rounded corners,draw=black,thin,fill=none,inner sep=.8mm,minimum size=4mm},
  ]{%
    \node[state] {{\footnotesize #1}};
  }
}
% ===================================================================
\section*{T4.12~ Beispiel für Backjumping}

Nehmen wir an, ein Knoten $v$ in einem I-Baum sei markiert wie folgt,
wobei die Konzepte in $\Lmc(v)$ durchnummeriert werden.
%
\begin{center}
  $\Lmc(v) = \{$%
  \begin{tikzpicture}[%
    >=Latex,baseline=-3pt,
    every state/.style={rectangle,rounded corners,draw=black,thin,fill=none,inner sep=.8mm,minimum size=4mm},
    every edge/.style={draw=black,thin}
  ]
  
    \node (1)                        {\strut $(\exists r.A) \sqcup B,$};
    \node (2)    [right=0mm of 1]    {\strut $A_1 \sqcup A_1',$};
    \node (dots) [right=0mm of 2]    {\strut $\dots,$};
    \node (n+1)  [right=0mm of dots] {\strut $A_n \sqcup A_n',$};
    \node (n+2)  [right=0mm of n+1]  {\strut $\forall r.\lnot A$};
    
    \node[state] (1')    [below=-1mm of 1]    {{\footnotesize 1}};
    \node[state] (2')    [below=-1mm of 2]    {{\footnotesize 2}};
    \node[state] (n+1')  [below=-1mm of n+1]  {{\footnotesize $n\!\!\:+\!\!\:1$}};
    \node[state] (n+2')  [below=-1mm of n+2]  {{\footnotesize $n\!\!\:+\!\!\:2$}};
  
  \end{tikzpicture}%
  $\}$
\end{center}
%
Nehmen wir weiterhin an, der Tableau-Algorithmus verarbeite die Konzepte aus $\Lmc(v)$ in der angegebenen Reihenfolge und wählt bei den Disjunktionen immer zuerst das linke Disjunkt.
Dann wird 
%
\begin{itemize}
  \item 
    im 1.\ Schritt das Konzept $\exists r.A$ zu $\Lmc(v)$ hinzugefügt \\
    ($\sqcup$-Regel auf \nr{1} angewendet);
  \item 
    im 2.\ Schritt ein $r$-Nachfolger $v'$ zu $v$ hinzugefügt und mit $\{A\}$ markiert \\
    ($\exists$-Regel auf $\exists r.A \in \Lmc(v)$ angewendet);
  \item
    im den nächsten $n$ Schritten die linken Disjunkte von \nr{2}--\nr{$n+1$}
    zu $\Lmc(v)$ hinzugefügt \\
    ($\sqcup$-Regel);
  \item
    im folgenden Schritt das Konzept $\lnot A$ zu $\Lmc(v')$ hinzugefügt \\ 
    ($\forall$-Regel auf $\forall r.\lnot A \in \Lmc(v)$ angewendet).
\end{itemize}
%
Danach sieht die "`Umgebung"' von $v$ im I-Baum wie folgt aus,
wobei die Einträge der Knotenlabels mit der Nummer des Konzeptes aus $\Lmc(v)$
versehen sind, von dem sie stammen (dies repräsentiert die "`Dependenzmenge"').
%
\begin{center}
  \begin{tikzpicture}[%
    >=Latex,baseline=.2pt,
    every state/.style={draw=black,thin,fill=black!10,inner sep=.5mm,minimum size=6mm},
    every edge/.style={draw=black,thin}
  ]
  
    \node[state] (v)                    {$v$};
    \node[state] (v') [below=14mm of v] {$v'$};
    
    \node (Lv)  [right=2mm of v]  {$\Lmc(v) \cup \{\exists r.A,\,A_1,\,\dots,\,A_n\}$};
    \node (Lv') [right=2mm of v'] {$\{A,~\lnot A\}$};

    \node (lightning) [below right=-6mm and -1mm of Lv']{{\Large \lightning}};
    
    \path[->] (v) edge node[right] (r) {$r$} (v');

    \begin{scope}[
      every node/.style={rectangle,rounded corners,draw=black,thin,fill=none,inner sep=.8mm,minimum size=4mm},
    ]
      
      \node (Lv1)    [below left=-1mm and -21mm of Lv] {{\footnotesize 1}};
      \node (Lv2)    [right=4mm of Lv1]                {{\footnotesize 2}};
      \node (Lvn+1)  [right=8mm of Lv2]               {{\footnotesize $n+1$}};
      \node (r1)     [right=-.5mm of r]                  {{\footnotesize 1}};
      \node (Lv'1)   [below left=-1mm and -6mm of Lv'] {{\footnotesize 1}};
      \node (Lv'n+2) [right=.5mm of Lv'1]               {{\footnotesize $n+2$}};
    \end{scope}
  \end{tikzpicture}
\end{center}
%
Wegen des offensichtlichen Widerspruchs in $v'$ (angezeigt durch \lightning)
muss Backtracking durchgeführt werden.
Einfaches Backtracking probiert hier aber $2^n$ sinnlose Alternativen aus,
nämlich sämtliche Kombination der jeweils zwei Disjunkte von \nr{2}--\nr{$n+1$},
und findet erst dann die Ursache des Problems:
Der Konflikt wurde letztlich durch das linke Disjunkt $\exists r.A$ von \nr{1}
und Konzept $\forall r.\lnot A$ \nr{$n+2$} ausgelöst.
Mit Backjumping hingegen wird wie im Bild angedeutet Buch über die Herkunft der Konzepte geführt; deshalb kann direkt zur Ursache des Problems zurückgesprungen werden -- hier zum 1.\ Schritt der obigen Aufzählung.

\pagebreak
% ===================================================================
\section*{T4.13~ Beispiel für Normalform der TBoxen}

Wir betrachten die TBox
\[
  \Tmc = \{A \sqsubseteq \exists r.B,~ A \sqcup B \sqsubseteq \forall r.B\}.
\]
Beim Umwandeln in Normalform werden zuerst die beiden Konzeptinklusionen
in eine einzige Konzeptinklusion mit $\top$ auf der linken Seite umgewandelt,
wie auf der Folie angegeben:
\[
  \{\top \sqsubseteq (\lnot A \sqcup \exists r.B) \sqcap (\lnot(A \sqcup B) \sqcup \forall r.B)\}
\]
Nun muss noch NNF hergestellt werden, indem die rechte Negation "`nach innen gezogen"' wird:
\[
  \Tmc' = \{\top \sqsubseteq (\lnot A \sqcup \exists r.B) \sqcap ((\lnot A \sqcap \lnot B) \sqcup \forall r.B)\}
\]
Es ist leicht zu zeigen, dass die bei resultierende TBox $\Tmc'$ immer äquivalent zur ursprünglichen TBox \Tmc ist, d.\,h.\ \Tmc und $\Tmc'$ haben dieselben Modelle.

% ===================================================================
\parbox[t]{.78\linewidth}{%
  \section*{T4.14~ Beispiel für Nicht-Terminierung}

  Sei $C_0 = A$ und $\Tmc = \{\top \sqsubseteq \exists r.A\}$ (bereits in Normalform).
  Wenn man das bisherige Tableau\-verfahren um die TBox-Regel erweitert,
  terminiert der Algorithmus auf der Eingabe $(C_0,\Tmc)$ nicht mehr,
  denn es sind immer abwechselnd die TBox-Regel und die $\exists$-Regel anwendbar,
  wodurch der nebenstehende unendliche I-Baum erzeugt wird.
}%
\hfill
\parbox[t]{.14\linewidth}{%
%%
%\begin{center}
  \begin{tikzpicture}[%
    >=Latex,baseline=24pt,
    every state/.style={draw=black,thin,fill=black!10,inner sep=.5mm,minimum size=4mm},
    every edge/.style={draw=black,thin}
  ]
  
    \node[state] (1)                      {};
    \node[state] (2)    [below=8mm of 1] {};
    \node[state] (3)    [below=8mm of 2] {};
    \node        (dots) [below=8mm of 3] {$\vdots$};
    
    \foreach \x in {1,2,3} \node [right=0mm of \x] {$A,\,\exists r.A$};
    
    \path[->]
      (1) edge node[right] {$r$} (2)
      (2) edge node[right] {$r$} (3)
      (3) edge node[right] {$r$} (dots)
    ;
  \end{tikzpicture}
%\end{center}
}

% ===================================================================
\section*{T4.15~ Beispiel für Blockierung}

\par\vspace*{-\baselineskip}
\parbox[t]{.4\linewidth}{%
  Im nebenstehenden I-Baum ist/sind
  %
  \begin{itemize}
    \item
      $v_1$ direkt blockiert durch $v_0$;
    \item
      $v_3$ direkt blockiert durch $v_0$;
    \item
      $v_1,v_3,v_4$ blockiert;
    \item
      $v_0,v_2$ \emph{nicht} blockiert.
  \end{itemize}
}%
\hfill
\parbox[t]{.48\linewidth}{%
%\begin{center}
  \begin{tikzpicture}[%
    >=Latex,baseline=.2pt,
    every state/.style={draw=black,thin,fill=black!10,inner sep=.2mm,minimum size=6mm},
    every edge/.style={draw=black,thin}
  ]
  
    \node[state] (v0)                                  {\strut $v_0$};
    \node[state] (v1) [below left =10mm and 5mm of v0] {\strut $v_1$};
    \node[state] (v2) [below right=10mm and 5mm of v0] {\strut $v_2$};
    \node[state] (v3) [below=10mm of v2]               {\strut $v_3$};
    \node[state] (v4) [below=10mm of v3]               {\strut $v_4$};    
    
%    \node [right=1mm of v0] {$A \sqcap \exists r.A,~ A,~ \exists r.A,~ \exists r.\exists r.(A \sqcap \exists r.A)$};
    \node [above right=-7mm and 1.5mm of v0] {\begin{tabular}{@{}l@{}}$A \sqcap \exists r.A$,\\$A,~ \exists r.A,~ \exists r.\exists r.(A \sqcap \exists r.A)$\end{tabular}};
    \node [left =1mm of v1] {$A$};
    \node [right=1mm of v2] {$\exists r.(A \sqcap \exists r.A)$};
    \node [right=1mm of v3] {$A \sqcap \exists r.A,~ A,~ \exists r.A$};
    \node [right=1mm of v4] {$A,~B$};
    
    \path[->]
      (v0) edge node[left=.4mm]  {$r$} (v1)
      (v0) edge node[right=.7mm] {$r$} (v2)
      (v2) edge node[right]     {$r$} (v3)
      (v3) edge node[right]     {$r$} (v4)
    ;
  \end{tikzpicture}
%\end{center}
}
%

% ===================================================================
\section*{{\boldmath T4.16~ Beispiel für die $\exists'$-Regel}}

Seien $C_0 = A \sqcap \exists r.\exists r.A$ und $\Tmc = \{\top \sqsubseteq \exists r.B\}$.
Dann erzeugt das Tableauverfahren mit der neuen $\exists'$-Regel (und Blockierung)
folgenden I-Baum.
%
\begin{center}
  \begin{tikzpicture}[%
    >=Latex,baseline=.2pt,
    every state/.style={draw=black,thin,fill=black!10,inner sep=.4mm,minimum size=5mm},
    every edge/.style={draw=black,thin}
  ]
  
    \node[state] (eps)                                    {$v_{\textsf{ini}}$};
    \node[state] (0)   [below left =10mm and 13mm of eps] {};
    \node[state] (1)   [below right=10mm and 13mm of eps] {};
    \node[state] (00)  [below left =10mm and  3mm of 0]   {};
    \node[state] (10)  [below left =10mm and  3mm of 1]   {};
    \node[state] (11)  [below right=10mm and  3mm of 1]   {};
    \node[state] (110) [below=10mm of 11]                 {};
    
    \node [right=1mm of eps] {$C_0,~ A,~ \exists r.\exists r.A,~ \exists r.B$};
    \node [left =1mm of 0]   {$\exists r.B,~ B$};
    \node [right=1mm of 1]   {$\exists r.A,~ \exists r.B$};
    \node [left =1mm of 00]  {$\exists r.B,~ B$};
    \node [left =1mm of 10]  {$A,~ \exists r.B$};
    \node [right=1mm of 11]  {$B,~ \exists r.B$};
    \node [right=1mm of 110] {$B,~ \exists r.B$};
    
    \path[->]
      (eps) edge node[pos=.3,left=.4mm]  {$r$} (0)
      (eps) edge node[pos=.3,right=.7mm] {$r$} (1)
      (0)   edge node[pos=.2,left=0mm]  {$r$} (00)
      (1)   edge node[pos=.2,left=0mm]  {$r$} (10)
      (1)   edge node[pos=.2,right=.3mm] {$r$} (11)
      (11)  edge node[pos=.2,right]      {$r$} (110)
    ;
    
    \path (0) --(00)  node[draw,cross out, pos=0.6] {};
    \path (1) --(10)  node[draw,cross out, pos=0.6] {};
    \path (11)--(110) node[draw,cross out, pos=0.6] {};
    
    \path[->,dashed]
      (0)  edge[out=290,in=350,looseness=12] (0)
      (1)  edge[out=180,in=270]              (eps)
      (11) edge[out=240,in=190,looseness=12] (11)
    ;
  \end{tikzpicture}
\end{center}
%
Blockierte Knoten sind dadurch gekennzeichnet, dass die eingehende $r$-Kante durchkreuzt ist.
Alle blockierten Knoten in diesem Beispiel sind direkt blockiert.

Die gestrichelten Pfeile zeigen an, durch welches Element der blockierte Nachfolger
blockiert wird.
Sie sind genau genommen nicht Bestandteil des I-Baums, aber sie werden
bei der Modellkonstruktion im Korrektheitsbeweis nützlich sein.

% ===================================================================
\section*{T4.17~ Verbleibender Beweis der Korrektheit (mit TBoxen)}

\textsfbf{Behauptung.}~
Für alle Konzepte $C$ und Knoten $v \in \Delta^\Imc$ gilt:
~~
$C \in \Lmc(v)$
~impliziert~
$v \in C^\Imc$

\parII
Man beachte, dass die Behauptung nur über die $v \in \Delta^\Imc$
eine Aussage macht, also über die im vollständigen I-Baum \Bmc \emph{unblockierten} Knoten.

\par\medskip
Zunächst zeigen wir, dass diese Behauptung die Aussage
des Theorems~4.13 impliziert.

Da $C_0 \in \Lmc(v_{\textsf{ini}})$,
gilt nach der obigen Behauptung $v_{\textsf{ini}} \in C_0^\Imc$.
Da außerdem die TBox-Regel nicht mehr anwendbar ist (\Bmc ist vollständig),
gilt $C_\Tmc \in \Lmc(v)$ für alle $v \in V$.
Wegen der Behauptung ist somit \Imc auch ein Modell von \Tmc.

\par\medskip
\textsfbf{Beweis der Behauptung}~
per Induktion über die Struktur von $C$.
Der Induktionsanfang ($C=A$) und die Fälle $C=\lnot A$, $C = D_1 \sqcap D_2$,
$C = D_1 \sqcup D_2$ im Induktionsschritt sind genauso wie in der Variante ohne TBoxen
(\textsf{\hyperlink{TBewKorrTableauxOhne}{\TBewKorrTableauxOhne}}). Für die übrigen zwei Fälle argumentieren wie wie folgt:
%
  \begin{description}
    \item[{\boldmath $C = \exists r.D$.}]
      Wegen $C \in \Lmc(v)$
      und da die $\exists'$-Regel nicht anwendbar ist,
      gibt es $v' \in V$ mit $(v,r,v') \in E$ und $D \in \Lmc(v')$.
      
      Falls $v'$ unblockiert ist, folgt $(v,v') \in r^\Imc$ nach Definition von \Imc
      und $v' \in D^\Imc$ nach Induktionsvoraussetzung.

      \parbox{.78\linewidth}{%      
        Falls $v'$ blockiert ist, argumentieren wir wie folgt:
        da der direkte Vorgänger von $v'$ der unblockierte Knoten $v$ ist,
        gibt es einen \emph{unblockierten} Vorgänger $u$ von $v'$,
        durch den $v'$ \emph{direkt} blockiert ist,
        siehe nebenstehende Skizze.
        (Der Knoten $u$ kann, aber muss nicht mit $v$ übereinstimmen;
        siehe das vorangehende Beispiel).
        Nach Definition von \Imc ist $(v,u) \in r^\Imc$.
        Da außerdem $D \in \Lmc(v') \subseteq \Lmc(u)$ gilt,
        ist $u \in D^\Imc$ nach Induktionsvoraussetzung.%
      }%
      \hfill
      \parbox{.14\linewidth}{%
        \begin{tikzpicture}[%
          >=Latex,baseline=.2pt,
          every state/.style={draw=black,thin,fill=black!10,inner sep=.5mm,minimum size=6mm},
          every edge/.style={draw=black,thin}
        ]
        
          \node[state] (u)                        {$u$};
%          \node        (dots) [below=4mm of u]    {$\vdots$};
          \node[circle,inner sep=0mm,minimum size=.2mm] (dots1) [below=3mm of u] {};
          \node[circle,inner sep=0mm,minimum size=.2mm] (dots2) [below=2mm of dots1] {};
          \node[state] (v)    [below=3mm of dots2] {$v$};
          \node[state] (v')   [below=8mm of v]    {$v'$};
          
          \path[->]
            (u)     edge (dots1)
            (dots1) edge[-,dotted,very thick] (dots2)
            (dots2) edge (v)
            (v)     edge node[pos=.2,right] {$r$} (v')
          ;
          
          \path (v)--(v') node[draw,cross out, pos=0.6] {};

          \path[->,dashed]
            (v) edge[out=10,in=350] (u)
          ;
          
        \end{tikzpicture}
      
      }
      
      In beiden Fällen folgt $v \in (\exists r.D)^\Imc$.
      
    \item[{\boldmath $C = \forall r.D$.}]
      Um zu zeigen, dass $v \in (\forall r.D)^\Imc$,
      betrachten wir ein beliebiges Element $u$ mit $(v,u) \in r^\Imc$
      und müssen zeigen, dass $u \in D^\Imc$.
      
      Nach Definition von $r^\Imc$ gibt es wegen $(v,u) \in r^\Imc$ zwei mögliche Fälle:
      
      (1) $(v,r,u) \in E$ für einen \emph{unblockierten} Knoten $u$.
      Da die $\forall$-Regel nicht anwendbar ist, gilt $D \in \Lmc(u)$,
      also nach Induktionsvoraussetzung $u \in D^\Imc$.
      
      (2) $(v,r,v') \in E$ für einen Knoten $v'$, der durch $u$ direkt blockiert wird;
      siehe wieder die obige Skizze.
      Da die $\forall$-Regel nicht anwendbar ist, gilt $D \in \Lmc(v')$.
      Da außerdem $\Lmc(v') \subseteq \Lmc(u)$, folgt auch hier $D \in \Lmc(u)$
      und nach IV $u \in D^\Imc$.
      \qedhere
  \end{description}

% ===================================================================
\section*{T4.18~ Tiefe der I-Bäume (mit TBoxen)}

\textsfbf{Behauptung.}~
Es werden nur I-Bäume mit einer Tiefe von maximal $2^k$ generiert,
wobei $k = |C_0| + |\Tmc|$.

\par\medskip
\textsfbf{Beweis.}~
Angenommen, es werde ein I-Baum der Tiefe $>2^k$ erzeugt.
Dazu muss irgendwann die $\exists'$-Regel auf einen Knoten $v$ der Tiefe $2^k$
angewendet werden.
Es gibt also einen Pfad $v_0,\dots,v_{2^k}$ von der Wurzel $v_0 = v_{\textsf{ini}}$
zum Knoten $v_{2^k} = v$ (zeichnet den Baum und den Pfad selbst auf).
Auf diesem Pfad gibt es $2^k+1$ Knoten.
Da es aber nur $2^{\textsf{sub}(C_0,\Tmc)} \leq 2^k$ mögliche Knotenbeschriftungen gibt,
muss es nach dem Schubfachprinzip zwei verschiedene Knoten $v_i,v_j$ auf dem Pfad geben
mit derselben Beschriftung $\Lmc(v_i) = \Lmc(v_j)$.
Also ist $v_j$ blockiert und damit auch $v$,
was ein Widerspruch zur oben gefolgerten Anwendung der $\exists'$-Regel ist.
Damit ist die Annahme widerlegt und die Behauptung bewiesen.
\qedhere

% ===================================================================
\section*{T4.19~ Beispiel für Absorption}

Wir betrachten die TBox, die aus folgenden zwei Konzeptinklusionen besteht.
%
%\begin{align*}
%  A           & \sqsubseteq C  \tag{1} \\
%  A \sqcap C' & \sqsubseteq D' \tag{2}
%\end{align*}
\[
  (1)~~ A \sqsubseteq C
  \qquad
  (2)~~ A \sqcap C' \sqsubseteq D'
\]
Die zweite kann man umformen in die äquivalente Konzeptinklusion
\[
  (2')~~ A \sqsubseteq \lnot C' \sqcup D'
\]
und dann in (1) "`absorbieren"', d.\,h.\ die folgende Konzeptinklusion ist äquivalent
zur ursprünglichen TBox:
\[
  A \sqsubseteq C \sqcap (\lnot C' \sqcup D')
\]
Bringt man diese Konzeptinklusion in Normalform $\top \sqsubseteq C_\Tmc$,
dann sind zwei Disjunktionen ineinander geschachtelt;
also erzeugt das Tableauverfahren 3 I-Bäume (probiert es aus).
Im Gegensatz dazu treten bei der Normalisierung von (1) und (2)
zwei Disjunktionen getrennt voneinander auf;
also erzeugt das Tableauverfahren 4 I-Bäume.
Durch Absorption hat man somit in diesem einfachen Beispiel
eine nichtdeterministische Auswahl gespart.

\goodbreak

% ===================================================================
% ===================================================================
% ===================================================================
\part{Komplexität}

%\parIII
%\parIII
%\dots\ Dokument wird fortgesetzt \dots
%
% ===================================================================
% ===================================================================
% ===================================================================
\part{Effiziente Beschreibungslogiken}

% ===================================================================
% ===================================================================
% ===================================================================
\part{ABoxen und Anfragebeantwortung}


%% ===================================================================
%% ===================================================================
%% ===================================================================
%\part*{Anhang}
%\addcontentsline{toc}{part}{Anhang}
%

\pagebreak
\addcontentsline{toc}{part}{Literaturverzeichnis}
\bibliographystyle{babalpha}
\bibliography{\jobname.bib}
\end{document}
